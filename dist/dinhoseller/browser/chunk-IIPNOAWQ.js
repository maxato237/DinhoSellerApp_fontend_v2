import{a as oe,b as Oe}from"./chunk-WSKZE47T.js";import{a as Le,b as et}from"./chunk-CAUO2NQ3.js";import{a as ie,b as re,c as ne}from"./chunk-CS5HP35B.js";import{A as De,B as Be,D as Xe,h as Ie,i as $e,j as Me,k as Te,l as Pe,m as Ve,n as Ge,o as Ae,t as te,u as ke,v as ye,w as Re,z as qe}from"./chunk-4SIVW3BL.js";import{Ja as k,Ka as g,Ma as R,Na as q,Pa as D,Qa as B,Ra as L,Sa as O,Ta as j,Ua as W,Va as Z,Wa as H,Xa as z,Ya as Q,Za as K,hc as U,ic as J,jc as Y,m as V,na as G,ra as A,rc as $,sc as X,t as Fe,tc as ee,va as Ne,ya as Se}from"./chunk-CJYIHCTA.js";import{Cb as S,Db as c,Eb as d,Ec as N,Fc as I,Gc as M,Ib as Ce,Kb as de,Lb as ce,Mb as fe,Nc as T,Qb as l,Ra as a,Rb as F,Sb as _e,Tc as P,Ub as ge,Vb as he,Wa as v,Wb as ve,Xb as we,Yb as y,Zb as b,a as ue,ab as E,b as be,d as me,ea as f,fa as _,fb as x,jc as C,nb as s,qb as w,tc as Ee,wb as n,xb as t,yb as u}from"./chunk-TMRP3J4S.js";function dt(p,r){if(p&1){let e=S();n(0,"i",45),c("click",function(){f(e);let o=d().index,m=d();return _(m.removeProduct(o))}),t()}}function ct(p,r){if(p&1){let e=S();n(0,"div",40)(1,"div",9)(2,"input",41),c("input",function(){let o=f(e).index,m=d();return _(m.addProductIfNeeded(o))}),t()(),n(3,"div",42)(4,"input",43),c("input",function(){let o=f(e).index,m=d();return _(m.addProductIfNeeded(o))}),t(),x(5,dt,1,0,"i",44),t()()}if(p&2){let e=r.index,i=d();s("formGroupName",e),a(5),s("ngIf",i.productsSupplied.length>1)}}var mt,le,pe,je=me(()=>{"use strict";P();K();Y();ee();ye();ne();Ee();K();Se();Oe();Fe();P();ee();Y();ne();mt=()=>({height:"100%",width:"3.5rem"}),le=p=>({"ng-invalid ng-dirty":p});pe=class p{constructor(r,e,i,o){this.fb=r;this.messageService=e;this.supplierService=i;this.router=o;this.supplierForm=this.fb.group({name:["",g.required],nc:[""],status:[null,g.required],address:[""],city:[""],postalCode:[""],country:[""],phone:["",g.required],email:["",[g.email]],website:[""],preferredPaymentMethod:[null,g.required],productsSupplied:this.fb.array([this.createProductFormGroup()])})}supplierForm;erreurInput=!1;responseError;loading=!1;status=[{name:"Active",code:"0"},{name:"Inactive",code:"1"}];preferredPaymentMethod=[{name:"Orange Money",code:"OM"},{name:"MTN Money",code:"MTN"},{name:"Virement",code:"VIR"},{name:"Esp\xE8ce",code:"ESP"},{name:"Ch\xE8que",code:"CHQ"}];countries=[{name:"Afrique du Sud",code:"ZA"},{name:"Alg\xE9rie",code:"DZ"},{name:"Angola",code:"AO"},{name:"B\xE9nin",code:"BJ"},{name:"Botswana",code:"BW"},{name:"Burkina Faso",code:"BF"},{name:"Burundi",code:"BI"},{name:"Cap-Vert",code:"CV"},{name:"Cameroun",code:"CM"},{name:"R\xE9publique centrafricaine",code:"CF"},{name:"Comores",code:"KM"},{name:"R\xE9publique du Congo",code:"CG"},{name:"R\xE9publique d\xE9mocratique du Congo",code:"CD"},{name:"Djibouti",code:"DJ"},{name:"\xC9gypte",code:"EG"},{name:"Guin\xE9e \xE9quatoriale",code:"GQ"},{name:"\xC9rythr\xE9e",code:"ER"},{name:"Eswatini",code:"SZ"},{name:"\xC9thiopie",code:"ET"},{name:"Gabon",code:"GA"},{name:"Gambie",code:"GM"},{name:"Ghana",code:"GH"},{name:"Guin\xE9e",code:"GN"},{name:"Guin\xE9e-Bissau",code:"GW"},{name:"C\xF4te d'Ivoire",code:"CI"},{name:"Kenya",code:"KE"},{name:"Lesotho",code:"LS"},{name:"Liberia",code:"LR"},{name:"Libye",code:"LY"},{name:"Madagascar",code:"MG"},{name:"Malawi",code:"MW"},{name:"Mali",code:"ML"},{name:"Mauritanie",code:"MR"},{name:"Maurice",code:"MU"},{name:"Maroc",code:"MA"},{name:"Mozambique",code:"MZ"},{name:"Namibie",code:"NA"},{name:"Niger",code:"NE"},{name:"Nigeria",code:"NG"},{name:"Rwanda",code:"RW"},{name:"Sao Tom\xE9-et-Principe",code:"ST"},{name:"S\xE9n\xE9gal",code:"SN"},{name:"Seychelles",code:"SC"},{name:"Sierra Leone",code:"SL"},{name:"Somalie",code:"SO"},{name:"Soudan",code:"SD"},{name:"Soudan du Sud",code:"SS"},{name:"Tanzanie",code:"TZ"},{name:"Togo",code:"TG"},{name:"Tunisie",code:"TN"},{name:"Ouganda",code:"UG"},{name:"Zambie",code:"ZM"},{name:"Zimbabwe",code:"ZW"}];ngOnInit(){}get productsSupplied(){return this.supplierForm.get("productsSupplied")}createProductFormGroup(){return this.fb.group({productName:[""],price:["",[g.min(0)]]})}addProductIfNeeded(r){let e=this.productsSupplied.at(r);if(e.get("productName")?.value!==""||e.get("price")?.value!==""){let i=this.productsSupplied.length-1;(this.productsSupplied.at(i).get("productName")?.value!==""||this.productsSupplied.at(i).get("price")?.value!=="")&&this.productsSupplied.push(this.createProductFormGroup())}}removeProduct(r){this.productsSupplied.length>1&&this.productsSupplied.removeAt(r)}onSubmit(){if(this.supplierForm.valid){console.log(this.supplierForm.value);let r=this.supplierForm.get("name")?.value,e=this.supplierForm.get("nc")?.value,i=this.supplierForm.get("status")?.value.name,o=this.supplierForm.get("address")?.value,m=this.supplierForm.get("city")?.value,h=this.supplierForm.get("postalCode")?.value,He=this.supplierForm.get("country")?.value,ze=this.supplierForm.get("phone")?.value,Qe=this.supplierForm.get("email")?.value,Ke=this.supplierForm.get("website")?.value,Ue=this.supplierForm.get("preferredPaymentMethod")?.value.name,Je=this.productsSupplied.value,Ye={nc:e,name:r,status:i,address:o,city:m,postalCode:h,country:He,phone:ze,email:Qe,website:Ke,preferredPaymentMethod:Ue,productsSupplied:Je};this.loading=!0,this.supplierService.addSupplier(Ye).subscribe({next:xe=>{this.showSuccess("Fournisseur ajout\xE9 avec succ\xE8s !"),this.supplierForm.reset(),this.productsSupplied.clear(),this.productsSupplied.push(this.createProductFormGroup()),this.loading=!1},error:xe=>{this.showError(xe.error.error),this.loading=!1}})}else this.erreurInput=!0,this.showError("Veuillez remplir tous les champs obligatoires.")}showSuccess(r){this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:r})}showError(r){this.messageService.add({severity:"error",summary:"Erreur",detail:r})}clearForm(){this.supplierForm.reset(),this.productsSupplied.clear(),this.productsSupplied.push(this.createProductFormGroup())}goToSupplierList(){this.router.navigate(["suppliers/list-suppliers"])}static \u0275fac=function(e){return new(e||p)(v(H),v(A),v(oe),v(V))};static \u0275cmp=E({type:p,selectors:[["app-addsupplier"]],decls:74,vars:21,consts:[[1,""],[1,"flex","gap-4","mb-12"],["icon","pi pi-arrow-left","severity","contrast",1,"text-xl",3,"click"],[1,"text-xl"],[1,"text-2xl","font-bold","text-primary"],[1,"w-full","mt-4",3,"ngSubmit","formGroup"],[1,"w-full","mt-4"],[1,"card","mt-6"],[1,"flex","flex-col","md:flex-row","gap-6","w-full"],[1,"flex","flex-wrap","gap-2","w-full"],["for","nc"],["pInputText","","type","text","id","nc","name","nc","formControlName","nc"],["for","name"],["pInputText","","type","text","id","name","name","name","formControlName","name","required","",3,"ngClass"],[1,"flex","flex-col","md:flex-row","gap-6","mt-6","w-full"],["for","status"],["formControlName","status","optionLabel","name","required","",1,"w-full",3,"options","ngClass"],["for","address"],["pInputText","","type","text","id","address","name","address","formControlName","address"],["for","city"],["pInputText","","type","text","id","city","name","city","formControlName","city"],["for","postalCode"],["pInputText","","type","text","id","postalCode","name","postalCode","formControlName","postalCode","required",""],["for","country"],["formControlName","country","optionLabel","name",1,"w-full",3,"options"],["for","phone"],["pInputText","","type","text","id","phone","name","phone","formControlName","phone","required","",3,"ngClass"],["for","email"],["pInputText","","type","email","id","email","name","email","formControlName","email"],["for","preferredPaymentMethod"],["formControlName","preferredPaymentMethod","optionLabel","name","required","",1,"w-full",3,"options","ngClass"],[1,"flex","mt-6","flex-wrap","gap-2","w-full"],["for","website"],["pInputText","","type","url","id","website","name","website","formControlName","website"],[1,"card"],["id","productsSupplied","formArrayName","productsSupplied",1,""],["class","flex flex-col md:flex-row gap-6 m-4 w-full",3,"formGroupName",4,"ngFor","ngForOf"],[1,"flex","flex-wrap","gap-4","mb-6","mt-6"],["label","Vider","icon","pi pi-times","severity","danger","outlined","",3,"click"],["type","submit","label","Enregister","icon","pi pi-save","severity","contrast",3,"loading"],[1,"flex","flex-col","md:flex-row","gap-6","m-4","w-full",3,"formGroupName"],["pInputText","","type","text","placeholder","Nom du produit","formControlName","productName",3,"input"],[1,"flex","gap-2","w-full",2,"align-items","center"],["pInputText","","type","number","placeholder","Prix","formControlName","price",3,"input"],["style",`
                                    margin-left: 1rem;
                                    cursor: pointer;
                                    color: red;
                                `,"class","fa-solid fa-xmark",3,"click",4,"ngIf"],[1,"fa-solid","fa-xmark",2,"margin-left","1rem","cursor","pointer","color","red",3,"click"]],template:function(e,i){e&1&&(n(0,"p-fluid")(1,"div",0)(2,"div",1)(3,"div")(4,"p-button",2),c("click",function(){return i.goToSupplierList()}),t()(),n(5,"div",0)(6,"div")(7,"span",3),l(8,"Retourner \xE0 la liste des fournisseurs"),t()(),n(9,"div")(10,"span",4),l(11,"Enregistrer un fournisseur"),t()()()()(),n(12,"form",5),c("ngSubmit",function(){return i.onSubmit()}),n(13,"div",6)(14,"h4"),l(15,"Informations du fournisseur"),t(),n(16,"div",7)(17,"div",8)(18,"div",9)(19,"label",10),l(20,"NC/NIU"),t(),u(21,"input",11),t(),n(22,"div",9)(23,"label",12),l(24,"Nom"),t(),u(25,"input",13),t()(),n(26,"div",14)(27,"div",9)(28,"label",15),l(29,"Statut"),t(),u(30,"p-select",16),t(),n(31,"div",9)(32,"label",17),l(33,"Adresse"),t(),u(34,"input",18),t()(),n(35,"div",14)(36,"div",9)(37,"label",19),l(38,"Ville"),t(),u(39,"input",20),t(),n(40,"div",9)(41,"label",21),l(42,"Code Postal"),t(),u(43,"input",22),t()(),n(44,"div",14)(45,"div",9)(46,"label",23),l(47,"Pays"),t(),u(48,"p-select",24),t(),n(49,"div",9)(50,"label",25),l(51,"T\xE9l\xE9phone"),t(),u(52,"input",26),t()(),n(53,"div",14)(54,"div",9)(55,"label",27),l(56,"Email"),t(),u(57,"input",28),t(),n(58,"div",9)(59,"label",29),l(60,"M\xE9thode de paiement pr\xE9f\xE9r\xE9e"),t(),u(61,"p-select",30),t()(),n(62,"div",31)(63,"label",32),l(64,"Site Web"),t(),u(65,"input",33),t()(),n(66,"h4"),l(67,"Produits fournis"),t(),n(68,"div",34)(69,"div",35),x(70,ct,6,2,"div",36),t()()(),n(71,"div",37)(72,"p-button",38),c("click",function(){return i.clearForm()}),t(),u(73,"p-button",39),t()()()),e&2&&(a(4),w(y(12,mt)),a(8),s("formGroup",i.supplierForm),a(13),s("ngClass",b(13,le,i.erreurInput&&i.supplierForm.controls.name.errors)),a(5),s("options",i.status)("ngClass",b(15,le,i.erreurInput&&i.supplierForm.controls.status.errors)),a(18),s("options",i.countries),a(4),s("ngClass",b(17,le,i.erreurInput&&i.supplierForm.controls.phone.errors)),a(9),s("options",i.preferredPaymentMethod)("ngClass",b(19,le,i.erreurInput&&i.supplierForm.controls.preferredPaymentMethod.errors)),a(9),s("ngForOf",i.productsSupplied.controls),a(3),s("loading",i.loading))},dependencies:[T,N,I,M,X,$,J,U,Q,D,k,B,R,q,Z,L,W,O,j,z,te,re,ie],encapsulation:2})}});function bt(p,r){p&1&&(n(0,"tr")(1,"th"),l(2,"Noms"),t(),n(3,"th"),l(4,"status"),t(),n(5,"th"),l(6,"Articles"),t(),n(7,"th"),l(8,"T\xE9l\xE9phone"),t(),u(9,"th"),t())}function Ct(p,r){if(p&1){let e=S();n(0,"tr")(1,"td",23),l(2),t(),n(3,"td"),l(4),t(),n(5,"td",24)(6,"p-button",25),c("click",function(){let o=f(e).$implicit,m=d(2);return _(m.showDialog(o.name))}),t()(),n(7,"td"),l(8),t(),n(9,"td")(10,"div",26)(11,"div")(12,"p-button",27),c("onClick",function(){let o=f(e).$implicit,m=d(2);return _(m.goToDetails(o))}),t()(),n(13,"div")(14,"p-button",28),c("click",function(o){let m=f(e).$implicit,h=d(2);return _(h.trash(o,m))}),t()()()()()}if(p&2){let e=r.$implicit;a(2),_e(" ",e.name," "),a(2),F(e.status),a(4),F(e.phone),a(4),s("outlined",!0),a(2),s("outlined",!0)}}function wt(p,r){if(p&1){let e=S();n(0,"div",12)(1,"div",13)(2,"div",14)(3,"div",15)(4,"p-iconfield"),u(5,"p-inputicon",16),n(6,"input",17),c("input",function(o){f(e);let m=d();return _(m.applyFilter(o))}),t()()()(),n(7,"div",18)(8,"p-button",19),c("click",function(){f(e);let o=d();return _(o.gotToAddSupplier())}),t(),n(9,"p-button",20),c("onClick",function(){f(e);let o=d();return _(o.exportCSV())}),t()()(),n(10,"div",21)(11,"p-table",22,3),x(13,bt,10,0,"ng-template",null,0,C)(15,Ct,15,5,"ng-template",null,4,C),t()()()}if(p&2){let e=d();a(11),s("value",e.suppliers)("globalFilterFields",y(6,St))("tableStyle",y(7,yt))("paginator",!0)("rows",40)("rowsPerPageOptions",y(8,xt))}}function Et(p,r){p&1&&(n(0,"div",29),u(1,"img",30),t())}function Ft(p,r){p&1&&(n(0,"tr")(1,"th"),l(2,"Nom"),t(),n(3,"th"),l(4,"Prix"),t()())}function Nt(p,r){if(p&1&&(n(0,"tr")(1,"td"),l(2),t(),n(3,"td"),l(4),t()()),p&2){let e=r.$implicit;a(2),F(e.productName),a(2),_e("FCFA ",e.supplierPrice,"")}}function It(p,r){if(p&1){let e=S();n(0,"i",66),c("click",function(){f(e);let o=d().index,m=d(2);return _(m.removeProduct(o))}),t()}}function Mt(p,r){if(p&1){let e=S();n(0,"div",61)(1,"div",35)(2,"input",62),c("input",function(){let o=f(e).index,m=d(2);return _(m.addProductIfNeeded(o))}),t()(),n(3,"div",63)(4,"input",64),c("input",function(){let o=f(e).index,m=d(2);return _(m.addProductIfNeeded(o))}),t(),x(5,It,1,0,"i",65),t()()}if(p&2){let e=r.index,i=d(2);s("formGroupName",e),a(5),s("ngIf",i.productsSupplied.length>1)}}function Tt(p,r){if(p&1){let e=S();n(0,"p-fluid")(1,"form",31),c("ngSubmit",function(){f(e);let o=d();return _(o.onSubmit())}),n(2,"div",32)(3,"h4"),l(4,"Informations du fournisseur"),t(),n(5,"div",33)(6,"div",34)(7,"div",35)(8,"label",36),l(9,"NC/NIU"),t(),u(10,"input",37),t(),n(11,"div",35)(12,"label",38),l(13,"Nom"),t(),u(14,"input",39),t(),n(15,"div",35)(16,"label",40),l(17,"Statut"),t(),u(18,"p-select",41),t()(),n(19,"div",42)(20,"div",35)(21,"label",43),l(22,"Adresse"),t(),u(23,"input",44),t(),n(24,"div",35)(25,"label",45),l(26,"Ville"),t(),u(27,"input",46),t()(),n(28,"div",42)(29,"div",35)(30,"label",47),l(31,"Code Postal"),t(),u(32,"input",48),t(),n(33,"div",35)(34,"label",49),l(35,"Pays"),t(),u(36,"p-select",50),t()(),n(37,"div",42)(38,"div",35)(39,"label",51),l(40,"T\xE9l\xE9phone"),t(),u(41,"input",52),t(),n(42,"div",35)(43,"label",53),l(44,"Email"),t(),u(45,"input",54),t()(),n(46,"div",42)(47,"div",35)(48,"label",55),l(49,"Site Web"),t(),u(50,"input",56),t(),n(51,"div",35)(52,"label",57),l(53,"M\xE9thode de paiement pr\xE9f\xE9r\xE9e"),t(),u(54,"p-select",58),t()()(),n(55,"h4"),l(56,"Produits fournis"),t(),n(57,"div")(58,"div",59),x(59,Mt,6,2,"div",60),t()()()()()}if(p&2){let e=d();a(),s("formGroup",e.supplierForm),a(13),s("ngClass",b(9,ae,e.erreurInput&&e.supplierForm.controls.name.errors)),a(4),s("options",e.status)("ngClass",b(11,ae,e.erreurInput&&e.supplierForm.controls.status.errors)),a(18),s("options",e.countries),a(5),s("ngClass",b(13,ae,e.erreurInput&&e.supplierForm.controls.phone.errors)),a(13),s("options",e.preferredPaymentMethod)("ngClass",b(15,ae,e.erreurInput&&e.supplierForm.controls.preferredPaymentMethod.errors)),a(5),s("ngForOf",e.productsSupplied.controls)}}function Pt(p,r){if(p&1){let e=S();n(0,"p-button",67),c("click",function(){f(e);let o=d();return _(o.clearForm())}),t(),n(1,"p-button",68),c("click",function(){f(e);let o=d();return _(o.onSubmit())}),t()}if(p&2){let e=d();a(),s("loading",e.loading)}}var ft,_t,gt,We,ht,vt,St,yt,xt,ae,se,Ze=me(()=>{"use strict";P();De();ee();Y();Se();et();Xe();K();ne();Pe();Ae();$e();ye();Ee();Oe();Fe();Se();K();De();P();Y();Ae();Pe();ne();ee();ye();ft=["dt"],_t=["op"],gt=()=>({width:"45vw","max-height":"50vh","overflow-y":"auto"}),We=()=>({"1199px":"75vw","575px":"90vw"}),ht=()=>({"min-width":"max-content"}),vt=()=>({width:"50vw","max-height":"90vh","overflow-y":"auto"}),St=()=>["name","code","phone"],yt=()=>({"min-width":"75vw"}),xt=()=>[10,20,40,60],ae=p=>({"ng-invalid ng-dirty":p});se=class p{constructor(r,e,i,o,m){this.supplierService=r;this.router=e;this.confirmationService=i;this.messageService=o;this.fb=m}dt;op;suppliers=[];visible=!1;supplierName;selectedSupplierProducts;supplierDetailsDialog=!1;supplierForm;erreurInput=!1;responseError;loading=!1;status=[{name:"Active",code:"0"},{name:"Inactive",code:"1"}];preferredPaymentMethod=[{name:"Orange Money",code:"OM"},{name:"MTN Money",code:"MTN"},{name:"Virement",code:"VIR"},{name:"Esp\xE8ce",code:"ESP"},{name:"Ch\xE8que",code:"CHQ"}];countries=[{name:"Afrique du Sud",code:"ZA"},{name:"Alg\xE9rie",code:"DZ"},{name:"Angola",code:"AO"},{name:"B\xE9nin",code:"BJ"},{name:"Botswana",code:"BW"},{name:"Burkina Faso",code:"BF"},{name:"Burundi",code:"BI"},{name:"Cap-Vert",code:"CV"},{name:"Cameroun",code:"CM"},{name:"R\xE9publique centrafricaine",code:"CF"},{name:"Comores",code:"KM"},{name:"R\xE9publique du Congo",code:"CG"},{name:"R\xE9publique d\xE9mocratique du Congo",code:"CD"},{name:"Djibouti",code:"DJ"},{name:"\xC9gypte",code:"EG"},{name:"Guin\xE9e \xE9quatoriale",code:"GQ"},{name:"\xC9rythr\xE9e",code:"ER"},{name:"Eswatini",code:"SZ"},{name:"\xC9thiopie",code:"ET"},{name:"Gabon",code:"GA"},{name:"Gambie",code:"GM"},{name:"Ghana",code:"GH"},{name:"Guin\xE9e",code:"GN"},{name:"Guin\xE9e-Bissau",code:"GW"},{name:"C\xF4te d'Ivoire",code:"CI"},{name:"Kenya",code:"KE"},{name:"Lesotho",code:"LS"},{name:"Liberia",code:"LR"},{name:"Libye",code:"LY"},{name:"Madagascar",code:"MG"},{name:"Malawi",code:"MW"},{name:"Mali",code:"ML"},{name:"Mauritanie",code:"MR"},{name:"Maurice",code:"MU"},{name:"Maroc",code:"MA"},{name:"Mozambique",code:"MZ"},{name:"Namibie",code:"NA"},{name:"Niger",code:"NE"},{name:"Nigeria",code:"NG"},{name:"Rwanda",code:"RW"},{name:"Sao Tom\xE9-et-Principe",code:"ST"},{name:"S\xE9n\xE9gal",code:"SN"},{name:"Seychelles",code:"SC"},{name:"Sierra Leone",code:"SL"},{name:"Somalie",code:"SO"},{name:"Soudan",code:"SD"},{name:"Soudan du Sud",code:"SS"},{name:"Tanzanie",code:"TZ"},{name:"Togo",code:"TG"},{name:"Tunisie",code:"TN"},{name:"Ouganda",code:"UG"},{name:"Zambie",code:"ZM"},{name:"Zimbabwe",code:"ZW"}];supplier={};ngOnInit(){this.supplierService.getAllSuppliers().subscribe({next:r=>{this.suppliers=r},error:r=>{console.error(r.error.error),this.showError(r.error.error)}}),this.supplierForm=this.fb.group({name:["",g.required],nc:[""],status:[null,g.required],address:[""],city:[""],postalCode:[""],country:[""],phone:["",g.required],email:["",[g.email]],website:[""],preferredPaymentMethod:[null,g.required],productsSupplied:this.fb.array([this.createProductFormGroup()])})}mapStatus(r){let e=this.status.find(i=>i.name===r);return e?parseInt(e.code,10):0}mapPaymentMethod(r){let e=this.preferredPaymentMethod.findIndex(i=>i.name===r);return e!==-1?e:0}mapCountry(r){let e=this.countries.findIndex(i=>i.name===r);return e!==-1?e:0}trash(r,e){this.confirmationService.confirm({target:r.target,message:"Voulez-vous supprimer ce fournisseur ?",header:"Supprimer",icon:"fa-solid fa-circle-info",rejectLabel:"annuler",rejectButtonProps:{label:"Annuler",severity:"secondary",outlined:!0},acceptButtonProps:{label:"Confirmer",severity:"danger"},accept:()=>{this.supplierService.deleteSupplier(e.id).subscribe({next:()=>{this.suppliers=this.suppliers.filter(i=>i.id!==e.id),this.showSuccess("Suppression r\xE9ussie")},error:()=>{this.showError("\xC9chec de la suppression")}})},reject:()=>{this.showError("supprission annul\xE9")}})}toggle(r){this.op.toggle(r)}showDialog(r){this.supplierService.get_products_supplied_by_supplier(r).subscribe({next:e=>{this.selectedSupplierProducts=e},error:e=>{this.showError(e.error.error)}}),this.visible=!0}onSubmit(){if(this.loading=!0,this.supplierForm.valid){let r=this.supplierForm.value.productsSupplied.filter(i=>i.productName.trim()!==""&&i.price!==""),e=be(ue(ue({},this.supplier),this.supplierForm.value),{productsSupplied:r});this.supplierService.updateSupplier(e,this.supplier.id).subscribe({next:i=>{this.showSuccess("Fournisseur mis \xE0 jour avec succ\xE8s !"),this.loading=!1;let o=this.suppliers.findIndex(m=>m.id===this.supplier.id);o!==-1&&(this.suppliers[o]=i,this.suppliers=[...this.suppliers])},error:i=>{this.showError(i.error.error),this.loading=!1}})}else this.erreurInput=!0,this.loading=!1,this.showError("Veuillez remplir tous les champs obligatoires.")}goToDetails(r){this.supplier=r,this.supplierForm=this.fb.group({name:[this.supplier.name,g.required],nc:[this.supplier.nc],status:[this.status[this.mapStatus(this.supplier.status)],g.required],address:[this.supplier.address],city:[this.supplier.city],postalCode:[this.supplier.postalCode],country:[this.countries[this.mapCountry(this.supplier.country)]||null],phone:[this.supplier.phone,g.required],email:[this.supplier.email,[g.email]],website:[this.supplier.website],preferredPaymentMethod:[this.preferredPaymentMethod[this.mapPaymentMethod(this.supplier.preferredPaymentMethod)]||null,g.required],productsSupplied:this.fb.array([])}),this.supplierService.get_products_supplied_by_supplier(r.name).subscribe({next:e=>{e.forEach(i=>{this.addProduct(i)}),this.addProduct()}}),this.supplierDetailsDialog=!0}addProduct(r={productName:"",supplierPrice:null,SupplierName:null}){var e=this.supplierForm.get("productsSupplied");e.push(this.fb.group({productName:[r.productName],price:[r.supplierPrice,[g.min(0)]]}))}get productsSupplied(){return this.supplierForm.get("productsSupplied")}createProductFormGroup(){return this.fb.group({productName:[""],price:["",[g.min(0)]]})}removeProduct(r){this.productsSupplied.length>1&&this.productsSupplied.removeAt(r)}addProductIfNeeded(r){let e=this.productsSupplied.at(r);if(e.get("productName")?.value!==""||e.get("price")?.value!==""){let i=this.productsSupplied.length-1;(this.productsSupplied.at(i).get("productName")?.value!==""||this.productsSupplied.at(i).get("price")?.value!=="")&&this.productsSupplied.push(this.createProductFormGroup())}}clearSelectedProducts(){this.selectedSupplierProducts=[]}applyFilter(r){let e=r.target;e&&this.dt.filterGlobal(e.value,"contains")}gotToAddSupplier(){this.router.navigate(["suppliers/addsupplier"])}exportCSV(){this.dt.exportCSV()}showSuccess(r){this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:r})}showError(r){this.messageService.add({severity:"error",summary:"Erreur",detail:r})}clearSelectedSuppliers(){this.selectedSupplierProducts=[]}clearForm(){this.supplierForm.reset()}static \u0275fac=function(e){return new(e||p)(v(oe),v(V),v(G),v(A),v(H))};static \u0275cmp=E({type:p,selectors:[["app-supplierslist"]],viewQuery:function(e,i){if(e&1&&(de(ft,5),de(_t,5)),e&2){let o;ce(o=fe())&&(i.dt=o.first),ce(o=fe())&&(i.op=o.first)}},features:[we([G])],decls:14,vars:25,consts:[["header",""],["content",""],["footer",""],["dt",""],["body",""],["class","card",4,"ngIf"],["style",`
        display: flex;
        align-items: center;
        justify-content: center;
        height: 89vh;
    `,4,"ngIf"],[1,""],["header","Les articles",3,"visibleChange","onHide","visible","modal","breakpoints","draggable","resizable"],["selectionMode","single",3,"value","tableStyle"],["pTemplate","body"],[3,"visibleChange","onHide","header","visible","modal","breakpoints","resizable"],[1,"card"],[1,"flex","justify-between","gap-4"],[1,"w-full"],[1,"flex","items-center","justify-between"],["styleClass","pi pi-search"],["pInputText","","type","text","placeholder","Rechercher un fournisseur...",3,"input"],[1,"flex","gap-4"],["label","Ajouter","icon","fa-solid fa-plus","severity","contrast",3,"click"],["label","Exporter","icon","pi pi-upload","severity","secondary",3,"onClick"],[1,"mt-4"],["selectionMode","single","dataKey","id",3,"value","globalFilterFields","tableStyle","paginator","rows","rowsPerPageOptions"],[1,"name-td"],[1,"showDialog"],["label","Voir les articles","severity","info","text","",3,"click"],[2,"display","flex","gap","1rem"],["label","","severity","info","icon","fa-solid fa-pencil",3,"onClick","outlined"],["label","","severity","danger","icon","fa-solid fa-trash-can",3,"click","outlined"],[2,"display","flex","align-items","center","justify-content","center","height","89vh"],["src","img/No data-rafiki.svg","alt","",2,"width","35rem"],[1,"w-full","mt-4",3,"ngSubmit","formGroup"],[1,"w-full","mt-4"],[1,"mt-6"],[1,"flex","flex-col","md:flex-row","gap-6","w-full"],[1,"flex","flex-wrap","gap-2","w-full"],["for","nc"],["pInputText","","type","text","id","nc","name","nc","formControlName","nc"],["for","name"],["pInputText","","type","text","id","name","name","name","formControlName","name","required","",3,"ngClass"],["for","status"],["formControlName","status","optionLabel","name","required","",1,"w-full",3,"options","ngClass"],[1,"flex","flex-col","md:flex-row","gap-6","mt-6","w-full"],["for","address"],["pInputText","","type","text","id","address","name","address","formControlName","address"],["for","city"],["pInputText","","type","text","id","city","name","city","formControlName","city"],["for","postalCode"],["pInputText","","type","text","id","postalCode","name","postalCode","formControlName","postalCode","required",""],["for","country"],["formControlName","country","optionLabel","name",1,"w-full",3,"options"],["for","phone"],["pInputText","","type","text","id","phone","name","phone","formControlName","phone","required","",3,"ngClass"],["for","email"],["pInputText","","type","email","id","email","name","email","formControlName","email"],["for","website"],["pInputText","","type","url","id","website","name","website","formControlName","website"],["for","preferredPaymentMethod"],["formControlName","preferredPaymentMethod","optionLabel","name","required","",1,"w-full",3,"options","ngClass"],["id","productsSupplied","formArrayName","productsSupplied",1,""],["class","flex flex-col md:flex-row gap-6 mb-3 w-full",3,"formGroupName",4,"ngFor","ngForOf"],[1,"flex","flex-col","md:flex-row","gap-6","mb-3","w-full",3,"formGroupName"],["pInputText","","type","text","placeholder","Nom du produit","formControlName","productName",3,"input"],[1,"flex","gap-2","w-full",2,"align-items","center"],["pInputText","","type","number","placeholder","Prix","formControlName","price",3,"input"],["style",`
                                            margin-left: 1rem;
                                            cursor: pointer;
                                            color: red;
                                        `,"class","fa-solid fa-xmark",3,"click",4,"ngIf"],[1,"fa-solid","fa-xmark",2,"margin-left","1rem","cursor","pointer","color","red",3,"click"],["label","Vider","icon","pi pi-times","severity","danger","outlined","",3,"click"],["type","submit","label","Enregister","icon","pi pi-save","severity","contrast",3,"click","loading"]],template:function(e,i){if(e&1){let o=S();x(0,wt,17,9,"div",5)(1,Et,2,0,"div",6),u(2,"p-confirmdialog"),n(3,"div",7)(4,"p-dialog",8),ve("visibleChange",function(h){return f(o),he(i.visible,h)||(i.visible=h),_(h)}),c("onHide",function(){return f(o),_(i.clearSelectedProducts())}),n(5,"p-table",9),x(6,Ft,5,0,"ng-template",null,0,C)(8,Nt,5,2,"ng-template",10),t()()(),n(9,"p-dialog",11),ve("visibleChange",function(h){return f(o),he(i.supplierDetailsDialog,h)||(i.supplierDetailsDialog=h),_(h)}),c("onHide",function(){return f(o),_(i.clearSelectedSuppliers())}),x(10,Tt,60,17,"ng-template",null,1,C)(12,Pt,2,1,"ng-template",null,2,C),t()}e&2&&(s("ngIf",i.suppliers.length>0),a(),s("ngIf",i.suppliers.length<=0),a(3),w(y(20,gt)),ge("visible",i.visible),s("modal",!0)("breakpoints",y(21,We))("draggable",!0)("resizable",!1),a(),s("value",i.selectedSupplierProducts)("tableStyle",y(22,ht)),a(4),w(y(23,vt)),Ce("header","Details du fournisseur ",i.supplier.name,""),ge("visible",i.supplierDetailsDialog),s("modal",!0)("breakpoints",y(24,We))("resizable",!1)("modal",!0))},dependencies:[qe,Re,Ne,T,N,I,M,J,U,Le,Be,Ge,Ve,Te,Me,re,ie,X,$,Ie,ke,te,z,D,k,B,R,q,Z,Q,L,W,O,j],encapsulation:2})}});var Si,Vt=me(()=>{je();Ze();Si=[{path:"addsupplier",component:pe},{path:"supplierslist",component:se}]});Vt();export{Si as default};
