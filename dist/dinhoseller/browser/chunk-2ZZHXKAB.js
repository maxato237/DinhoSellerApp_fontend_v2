import{a as ne,b as ye,c as se,d as _e,e as ae,f as Ce,g as me,h as Fe,i as ce,j as we}from"./chunk-YV2G342Q.js";import{a as le,b as Me}from"./chunk-LL2ZJJWF.js";import{c as pe,d as Ee}from"./chunk-YU2WID2Z.js";import{A as Se,B as te,C as oe,D as re,t as $,u as x,v as ee,z as ie}from"./chunk-G4MIH6TC.js";import{a as Y,b as be}from"./chunk-AT4MPLQG.js";import{Ka as u,Ma as G,Na as j,Pa as q,Ra as V,Ua as H,Va as L,Wa as z,Xa as W,Ya as k,Za as Q,fc as J,gc as K,hb as U,hc as X,ib as he,m as O,qc as Z,ra as R,rc as Ie,t as fe,ya as ge}from"./chunk-O72UO5PQ.js";import{$c as B,Db as b,Ec as A,Nc as P,Qb as _,Ra as c,Tc as T,Ub as C,Vb as F,Wa as n,Wb as w,Wc as D,Xc as N,Yb as I,Zb as M,Zc as S,_c as y,ab as d,d as g,hd as ve,nb as l,qb as h,tc as E,wb as o,xb as m,yb as p}from"./chunk-TMRP3J4S.js";var Te,De,Ne,v,ue=g(()=>{"use strict";Ie();ee();T();Q();Se();_e();he();Ce();ye();ve();X();Fe();re();E();Q();we();Me();Ee();be();ge();fe();T();ee();X();re();Te=()=>({width:"25rem"}),De=s=>({"ng-invalid ng-dirty":s}),Ne=()=>({width:"100%"}),v=class s{constructor(i,t,e,a,r,Oe,Re){this.fb=i;this.invoiceService=t;this.clientService=e;this.productService=a;this.appSetting=r;this.messageService=Oe;this.router=Re;this.invoiceForm=this.fb.group({HT:["0.0"],TTC:["0.0"],TVA:["0.0"],PRECOMPTE:["0.0"],client:[null,u.required],status:[null,u.required],avance:[null],echeance:[null],dateAdded:[null,u.required],lignes:this.fb.array([])}),this.nbInvioicesForm=this.fb.group({nbInvioices:[null,u.required]})}clients=[];status=[];products=[];selectedProduct=[];invoiceForm;nbInvioicesForm;showsSubmitButton=!0;settings;copied=!1;showInputs=!0;erreurInput=!1;visible=!1;nombreFactures=[];dividedInvoices=[];nbInvioices=0;items=[];ngOnInit(){this.clientService.getAllClients().subscribe({next:i=>this.clients=i,error:i=>this.showError(i.error.error)}),this.productService.getAllProducts().subscribe({next:i=>this.products=i,error:i=>this.showError(i.error.error)}),this.settings=this.appSetting.settings,this.status=[{name:"Pay\xE9e",code:0},{name:"Partiellement pay\xE9e",code:1},{name:"Impay\xE9e",code:2}],this.items=[{label:"Diviser la facture",icon:"pi pi-percentage",command:()=>this.showDialog()}]}showDialog(){this.visible=!0,this.generateDivisionOptions()}generateDivisionOptions(){let i=this.getLignesPleines().length;this.nombreFactures=[];for(let t=2;t<=i;t++)this.nombreFactures.push(t)}getLignesPleines(){return this.invoiceForm.get("lignes").controls.filter(i=>i.get("DESIGNATION")?.value&&i.get("QUANTITY")?.value)}navigateToDivision(){if(this.nbInvioicesForm.valid){let i=this.nbInvioicesForm.get("nbInvioices")?.value,t=this.invoiceForm.get("client")?.value,e=this.getLignesPleines().map(r=>r.value),a=this.invoiceForm.get("status")?.value;this.router.navigate(["/invoices/divide-invoice"],{state:{client:t,lignes:e,status:a,nombreFactures:i}})}else this.erreurInput=!0,this.showError("Veuillez remplir le nombre de factures.")}showError(i){this.messageService.add({severity:"error",summary:"Erreur",detail:i})}clearForm(){}onInvoiceSubmitted(){let i=this.invoiceForm.getRawValue();this.invoiceService.addInvoice(i).subscribe({next:t=>{this.router.navigate(["/invoices/print-invoice"],{state:{invoice:i,isOneInvoice:!0,code_facture:t.message.code_facture}})},error:()=>{this.showError("Erreur inatendu !")}})}static \u0275fac=function(t){return new(t||s)(n(z),n(ce),n(le),n(pe),n(Y),n(R),n(O))};static \u0275cmp=d({type:s,selectors:[["app-addinvoice"]],decls:9,vars:26,consts:[[3,"submitted","cleared","error","form","clients","status","products","showsSubmitButton","selectedProduct","settings","showInputs","erreurInput","copied","items","isOneInvoice"],["header","Nombre de factures divis\xE9es",3,"visibleChange","modal","visible"],[1,"p-text-secondary","block","mb-8"],[3,"ngSubmit","formGroup"],[1,"flex","items-center","gap-4","mb-4"],["placeholder","S\xE9lectionner le nombre de factures","formControlName","nbInvioices","required","",1,"w-full",3,"options","appendTo","ngClass"],["type","submit","label","Valider","severity","contrast"]],template:function(t,e){t&1&&(o(0,"app-invoice-form",0),b("submitted",function(){return e.onInvoiceSubmitted()})("cleared",function(){return e.clearForm()})("error",function(r){return e.showError(r)}),m(),o(1,"p-dialog",1),w("visibleChange",function(r){return F(e.visible,r)||(e.visible=r),r}),o(2,"p",2),_(3," Avant de continuer veillez s\xE9lectionner le nombre de facture divis\xE9es que vous voulez. "),m(),o(4,"form",3),b("ngSubmit",function(){return e.navigateToDivision()}),o(5,"div",4),p(6,"p-select",5),m(),o(7,"div"),p(8,"p-button",6),m()()()),t&2&&(l("form",e.invoiceForm)("clients",e.clients)("status",e.status)("products",e.products)("showsSubmitButton",e.showsSubmitButton)("selectedProduct",e.selectedProduct)("settings",e.settings)("showInputs",e.showInputs)("erreurInput",e.erreurInput)("copied",e.copied)("items",e.items)("isOneInvoice",!0),c(),h(I(22,Te)),l("modal",!0),C("visible",e.visible),c(3),l("formGroup",e.nbInvioicesForm),c(2),l("options",e.nombreFactures)("appendTo","body")("ngClass",M(23,De,e.erreurInput&&e.nbInvioicesForm.controls.nbInvioices.errors)),c(2),h(I(25,Ne)))},dependencies:[P,A,x,$,Z,W,q,G,j,L,ie,se,U,K,J,ae,k,V,H,ne,me,oe,te],styles:[".autocomplete-wrapper[_ngcontent-%COMP%]   .p-autocomplete[_ngcontent-%COMP%]{width:100%!important}  .autocomplete-wrapper .p-autocomplete{width:100%!important}  .autocomplete-wrapper .p-inputtext{border:none!important;box-shadow:none!important;width:27rem!important}"],data:{animation:[D("slideToggle",[y("visible",S({height:"*",opacity:1,overflow:"visible"})),y("hidden",S({height:"0px",opacity:0,overflow:"hidden"})),B("visible <=> hidden",[N("300ms ease-in-out")])])]}})}});var f,de=g(()=>{"use strict";E();f=class s{static \u0275fac=function(t){return new(t||s)};static \u0275cmp=d({type:s,selectors:[["app-invoiceslist"]],decls:2,vars:0,consts:[[2,"display","flex","align-items","center","justify-content","center","height","89vh"],["src","img/No data-rafiki.svg","alt","",2,"width","35rem"]],template:function(t,e){t&1&&(o(0,"div",0),p(1,"img",1),m())},encapsulation:2})}});var di,Be=g(()=>{ue();de();di=[{path:"addinvoice",component:v},{path:"invoiceslist",component:f}]});Be();export{di as default};
