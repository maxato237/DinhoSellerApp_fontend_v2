import{a as Ct,b as Vt}from"./chunk-CVBMZPTJ.js";import{a as Ce,b as xe,c as Se,d as vt,f as Ot,g as ht,h as qt,i as yt,j as Nt}from"./chunk-J743F2QU.js";import{g as fe,h as _e,i as be,j as pt,k as mt,l as ut,m as ct,n as dt,o as gt,p as ve,q as he,r as ye,s as ft,v as _t,w as bt}from"./chunk-PHNKNGKI.js";import{$b as pe,Da as Y,Ea as u,Ga as Z,Ha as ee,Ja as te,La as re,Oa as ie,Pa as ne,Q as lt,Qa as oe,Ra as le,Sa as ae,Ta as se,Ua as st,Va as Mt,a as rt,ac as me,b as it,bc as ue,e as nt,ga as It,ia as W,jc as ce,kc as de,l as U,lc as ge,ma as K,pa as J,qa as Ge,s as ot,sa as X,xa as at,ya as kt}from"./chunk-MJGBYBNV.js";import{k as M,l as Be,m as R,n as De,o as $e,p as et,r as O,t as tt,x as q}from"./chunk-GCAJPEYL.js";import{$a as E,$b as Je,Ab as F,Bb as V,Eb as _,Fb as d,Jb as We,Kb as P,Lb as A,Mb as x,Nb as S,Qa as a,Rb as p,S as Le,Sb as Q,T as z,Tb as I,Ub as Ke,Va as C,Vb as qe,Wb as Ne,Xb as Ve,Y as Pe,Yb as H,Z as Ie,Zb as y,_b as g,a as Fe,ac as k,cc as Xe,d as G,da as v,db as He,ea as h,eb as b,gc as Ye,ha as ke,ic as Ze,jc as B,lb as Ue,mb as s,pb as N,qb as Me,ra as Ae,rb as Oe,vb as l,wa as Qe,wb as o,xb as m,xc as D,yb as j,zb as L}from"./chunk-PHRQPCRV.js";var $,ze=G(()=>{"use strict";q();nt();D();qt();D();nt();$=class t{constructor(r,e){this.http=r;this.platformId=e}BaseUrl=ht.api;httpOption(){let r=null;return tt(this.platformId)&&(r=localStorage.getItem("token")),{headers:new rt({Authorization:`Bearer ${r}`})}}addProduct(r){return this.http.post(`${this.BaseUrl}stocks/add`,r,this.httpOption())}updateProduct(r,e){return this.http.put(`${this.BaseUrl}stocks/update/${e}`,r,this.httpOption())}getAllProducts(){return this.http.get(`${this.BaseUrl}stocks/all`,this.httpOption())}getProductById(r){return this.http.get(`${this.BaseUrl}stocks/getProductById/${r}`,this.httpOption())}deleteProduct(r){return this.http.delete(`${this.BaseUrl}stocks/delete/${r}`,this.httpOption())}get_products_supplied_by_product(r){return this.http.get(`${this.BaseUrl}stocks/suppliers_by_product/${r}`,this.httpOption())}static \u0275fac=function(e){return new(e||t)(Pe(it),Pe(Qe))};static \u0275prov=z({token:t,factory:t.\u0275fac,providedIn:"root"})}});var Qt,T,Te,Tt=G(()=>{"use strict";Se();ge();ue();ye();se();q();be();D();se();ot();ze();X();Vt();ge();be();Se();ue();ye();q();Qt=()=>({height:"100%",width:"3.5rem"}),T=t=>({"ng-invalid ng-dirty":t}),Te=class t{constructor(r,e,i,n,c){this.fb=r;this.router=e;this.productService=i;this.messageService=n;this.supplierService=c}productForm;categories=[{name:"Boissons",code:"0"},{name:"\xC9picerie",code:"1"},{name:"Produits Surgel\xE9s",code:"2"},{name:"Boulangerie & P\xE2tisserie",code:"3"},{name:"Produits d\u2019Hygi\xE8ne",code:"4"},{name:"Entretien & Nettoyage",code:"5"}];suppliers;erreurInput=!1;responseError;loading=!1;ngOnInit(){this.initForm(),this.loadSuppliers()}initForm(){this.productForm=this.fb.group({code:["",u.required],reference:["",u.required],name:["",u.required],category:[null,u.required],quantity:[null,[u.required,u.min(1)]],minimum_stock:[null,[u.required,u.min(1)]],weight:[null,[u.min(0)]],brand:[""],supplier:[null,u.required]})}loadSuppliers(){this.supplierService.getAllSuppliers().subscribe({next:r=>{this.suppliers=r},error:r=>{console.error("Erreur lors du chargement des fournisseurs",r)}})}onSubmit(){if(this.loading=!0,this.productForm.valid){let r=this.productForm.value;this.productService.addProduct(r).subscribe({next:e=>{this.showSuccess("Produit ajout\xE9 avec succ\xE8s !"),this.loading=!1},error:e=>{this.showError(e.error.error),this.loading=!1}})}else this.erreurInput=!0,this.loading=!1,console.log("erreur dans le formulaire"),this.showError("Veuillez remplir tous les champs obligatoires.")}showSuccess(r){this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:r})}showError(r){this.messageService.add({severity:"error",summary:"Erreur",detail:r})}backToListPage(){this.router.navigate(["/products/productslist"])}clearForm(){this.productForm.reset()}static \u0275fac=function(e){return new(e||t)(C(oe),C(U),C($),C(K),C(Ct))};static \u0275cmp=E({type:t,selectors:[["app-addproduct"]],decls:55,vars:34,consts:[[1,""],[1,"flex","gap-4","mb-12"],["icon","pi pi-arrow-left","severity","contrast",1,"text-xl",3,"click"],[1,"text-xl"],[1,"text-2xl","font-bold","text-primary"],[1,"card","flex","flex-col","gap-6","w-full","mt-6",3,"ngSubmit","formGroup"],[1,"flex","flex-col","md:flex-row","gap-6","mt-8"],[1,"flex","flex-wrap","gap-2","w-full"],["for","code"],["pInputText","","type","text","id","code","name","code","formControlName","code","required","",3,"ngClass"],["for","reference"],["pInputText","","type","text","id","reference","name","reference","formControlName","reference","required","",3,"ngClass"],["for","designation"],["pInputText","","type","text","id","name","name","name","formControlName","name","required","",3,"ngClass"],[1,"flex","flex-col","md:flex-row","gap-6"],["for","category"],["formControlName","category","optionLabel","name","required","",1,"w-full",3,"options","ngClass"],["for","quantity"],["type","text","id","quantity","name","quantity","formControlName","quantity","showButtons","","mode","decimal","required","",3,"ngClass"],["for","reorderThreshold"],["type","text","id","minimum_stock","name","minimum_stock","formControlName","minimum_stock","required","","showButtons","","mode","decimal",3,"ngClass"],["for","weight"],["type","text","id","weight","name","weight","formControlName","weight","showButtons","","mode","decimal",3,"ngClass"],["for","brand"],["pInputText","","type","text","id","brand","name","brand","formControlName","brand",3,"ngClass"],["for","supplier"],["formControlName","supplier","optionLabel","name","required","",1,"w-full",3,"options","ngClass"],[1,"flex","flex-wrap","gap-4","mb-6","mt-6"],["label","Vider","icon","pi pi-times","severity","danger","outlined","",3,"click"],["type","submit","label","Enregister","icon","pi pi-save","severity","contrast",3,"loading"]],template:function(e,i){e&1&&(l(0,"p-fluid")(1,"div",0)(2,"div",1)(3,"div")(4,"p-button",2),_("click",function(){return i.backToListPage()}),o()(),l(5,"div",0)(6,"div")(7,"span",3),p(8,"Retourner \xE0 la liste des articles"),o()(),l(9,"div")(10,"span",4),p(11,"Enregistrer un article"),o()()()()(),l(12,"form",5),_("ngSubmit",function(){return i.onSubmit()}),l(13,"div",6)(14,"div",7)(15,"label",8),p(16,"Code"),o(),m(17,"input",9),o(),l(18,"div",7)(19,"label",10),p(20,"R\xE9f\xE9rence"),o(),m(21,"input",11),o(),l(22,"div",7)(23,"label",12),p(24,"Designation"),o(),m(25,"input",13),o()(),l(26,"div",14)(27,"div",7)(28,"label",15),p(29,"Cat\xE9gorie"),o(),m(30,"p-select",16),o(),l(31,"div",7)(32,"label",17),p(33,"Quantit\xE9 en stock"),o(),m(34,"p-inputnumber",18),o(),l(35,"div",7)(36,"label",19),p(37,"Seuil de r\xE9approvisionnement"),o(),m(38,"p-inputnumber",20),o()(),l(39,"div",14)(40,"div",7)(41,"label",21),p(42,"Poids(G)"),o(),m(43,"p-inputnumber",22),o(),l(44,"div",7)(45,"label",23),p(46,"Marque"),o(),m(47,"input",24),o(),l(48,"div",7)(49,"label",25),p(50,"Nom du fournisseur"),o(),m(51,"p-select",26),o()(),l(52,"div",27)(53,"p-button",28),_("click",function(){return i.clearForm()}),o(),m(54,"p-button",29),o()()()),e&2&&(a(4),N(y(15,Qt)),a(8),s("formGroup",i.productForm),a(5),s("ngClass",g(16,T,i.erreurInput&&i.productForm.controls.code.errors)),a(4),s("ngClass",g(18,T,i.erreurInput&&i.productForm.controls.reference.errors)),a(4),s("ngClass",g(20,T,i.erreurInput&&i.productForm.controls.name.errors)),a(5),s("options",i.categories)("ngClass",g(22,T,i.erreurInput&&i.productForm.controls.category.errors)),a(4),s("ngClass",g(24,T,i.erreurInput&&i.productForm.controls.quantity.errors)),a(4),s("ngClass",g(26,T,i.erreurInput&&i.productForm.controls.minimum_stock.errors)),a(5),s("ngClass",g(28,T,i.erreurInput&&i.productForm.controls.weight.errors)),a(4),s("ngClass",g(30,T,i.erreurInput&&i.productForm.controls.brand.errors)),a(4),s("options",i.suppliers)("ngClass",g(32,T,i.erreurInput&&i.productForm.controls.supplier.errors)),a(3),s("loading",i.loading))},dependencies:[de,ce,_e,fe,xe,Ce,me,pe,he,ve,le,te,Y,Z,ee,ne,ae,re,ie,O,M],encapsulation:2})}});function Jt(t,r){if(t&1&&m(0,"i",8),t&2){let e=d(2).$implicit;Me(e.icon),s("ngClass",y(4,Ut))("ngStyle",g(5,Wt,e.color))}}function Xt(t,r){if(t&1&&m(0,"span",9),t&2){let e=d(2).$implicit;s("ngStyle",g(1,Kt,e.color))}}function Yt(t,r){if(t&1&&(j(0),b(1,Jt,1,7,"i",6)(2,Xt,1,3,"span",7),L()),t&2){let e=d().$implicit;a(),s("ngIf",e.icon),a(),s("ngIf",!e.icon)}}function Zt(t,r){t&1&&F(0)}function er(t,r){if(t&1&&(l(0,"li",2),b(1,Yt,3,2,"ng-container",3)(2,Zt,1,0,"ng-container",4),l(3,"span",5),p(4),o()()),t&2){let e=r.$implicit,i=d();a(),s("ngIf",!i.iconTemplate),a(),s("ngTemplateOutlet",i.iconTemplate)("ngTemplateOutletContext",Je(5,Ht,e,e.icon)),a(2),Ke("",e.label," (",i.parentInstance.percentValue(e.value),")")}}function sr(t,r){if(t&1&&m(0,"p-meterGroupLabel",6),t&2){let e=d(2);s("value",e.value)("labelPosition",e.labelPosition)("labelOrientation",e.labelOrientation)("min",e.min)("max",e.max)("iconTemplate",e.iconTemplate||e._iconTemplate)}}function pr(t,r){t&1&&F(0)}function mr(t,r){if(t&1&&b(0,sr,1,6,"p-meterGroupLabel",5)(1,pr,1,0,"ng-container",2),t&2){let e=d();s("ngIf",!e.labelTemplate&&!e._labelTemplate),a(),s("ngTemplateOutlet",e.labelTemplate||e.labelTemplate)("ngTemplateOutletContext",k(3,we,e.value,e.totalPercent(),e.percentages()))}}function ur(t,r){t&1&&F(0)}function cr(t,r){t&1&&F(0)}function dr(t,r){if(t&1&&(j(0),m(1,"span",8),L()),t&2){let e=d().$implicit,i=d();a(),s("ngStyle",i.meterStyle(e))}}function gr(t,r){if(t&1&&(j(0),b(1,cr,1,0,"ng-container",2)(2,dr,2,1,"ng-container",7),L()),t&2){let e=r.$implicit,i=r.index,n=d();a(),s("ngTemplateOutlet",n.meterTemplate||n._meterTemplate)("ngTemplateOutletContext",Xe(3,ar,e,i,n.orientation,n.percentValue(e.value),n.totalPercent())),a(),s("ngIf",!n.meterTemplate&&!n._meterTemplate&&e.value>0)}}function fr(t,r){t&1&&F(0)}function _r(t,r){if(t&1&&m(0,"p-meterGroupLabel",6),t&2){let e=d(2);s("value",e.value)("labelPosition",e.labelPosition)("labelOrientation",e.labelOrientation)("min",e.min)("max",e.max)("iconTemplate",e.iconTemplate||e._iconTemplate)}}function br(t,r){t&1&&F(0)}function vr(t,r){if(t&1&&b(0,_r,1,6,"p-meterGroupLabel",5)(1,br,1,0,"ng-container",2),t&2){let e=d();s("ngIf",!e.labelTemplate&&!e._labelTemplate),a(),s("ngTemplateOutlet",e.labelTemplate||e._labelTemplate)("ngTemplateOutletContext",k(3,we,e.value,e.totalPercent(),e.percentages()))}}var Ht,Ut,Wt,Kt,tr,rr,ir,nr,or,lr,we,ar,hr,yr,wt,Cr,je,Et=G(()=>{"use strict";q();q();D();D();It();X();Mt();kt();Ht=(t,r)=>({$implicit:t,icon:r}),Ut=()=>({"p-metergroup-label-icon":!0}),Wt=t=>({color:t}),Kt=t=>({backgroundColor:t});tr=["label"],rr=["meter"],ir=["end"],nr=["start"],or=["icon"],lr=["container"],we=(t,r,e)=>({$implicit:t,totalPercent:r,percentages:e}),ar=(t,r,e,i,n)=>({$implicit:t,index:r,orientation:e,class:"p-metergroup-meter",size:i,totalPercent:n});hr=({dt:t})=>`
.p-metergroup {
    display: flex;
    gap: ${t("metergroup.gap")};
}

.p-metergroup-meters {
    display: flex;
    background: ${t("metergroup.meters.background")};
    border-radius: ${t("metergroup.border.radius")};
}

.p-metergroup-label-list {
    display: flex;
    flex-wrap: wrap;
    margin: 0;
    padding: 0;
    list-style-type: none;
}

.p-metergroup-label {
    display: inline-flex;
    align-items: center;
    gap: ${t("metergroup.label.gap")};
}

.p-metergroup-label-marker {
    display: inline-flex;
    width: ${t("metergroup.label.marker.size")};
    height: ${t("metergroup.label.marker.size")};
    border-radius: 100%;
}

.p-metergroup-label-icon {
    font-size: ${t("metergroup.label.icon.size")};
    width: ${t("metergroup.label.icon.size")};
    height: ${t("metergroup.label.icon.size")};
}

.p-metergroup-horizontal {
    flex-direction: column;
}

.p-metergroup-label-list-horizontal {
    gap: ${t("metergroup.label.list.horizontal.gap")};
}

.p-metergroup-horizontal .p-metergroup-meters {
    height: ${t("metergroup.meters.size")};
}

.p-metergroup-horizontal .p-metergroup-meter:first-of-type {
    border-start-start-radius: ${t("metergroup.border.radius")};
    border-end-start-radius: ${t("metergroup.border.radius")};
}

.p-metergroup-horizontal .p-metergroup-meter:last-of-type {
    border-start-end-radius: ${t("metergroup.border.radius")};
    border-end-end-radius: ${t("metergroup.border.radius")};
}

.p-metergroup-vertical {
    flex-direction: row;
}

.p-metergroup-label-list-vertical {
    flex-direction: column;
    gap: ${t("metergroup.label.list.vertical.gap")};
}

.p-metergroup-vertical .p-metergroup-meters {
    flex-direction: column;
    width: ${t("metergroup.meters.size")};
    height: 100%;
}

.p-metergroup-vertical .p-metergroup-label-list {
    align-items: start;
}

.p-metergroup-vertical .p-metergroup-meter:first-of-type {
    border-start-start-radius: ${t("metergroup.border.radius")};
    border-start-end-radius: ${t("metergroup.border.radius")};
}
.p-metergroup-vertical .p-metergroup-meter:last-of-type {
    border-end-start-radius: ${t("metergroup.border.radius")};
    border-end-end-radius: ${t("metergroup.border.radius")};
}
`,yr={root:({props:t})=>["p-metergroup p-component",{"p-metergroup-horizontal":t.orientation==="horizontal","p-metergroup-vertical":t.orientation==="vertical"}],meters:"p-metergroup-meters",meter:"p-metergroup-meter",labelList:({props:t})=>["p-metergroup-label-list",{"p-metergroup-label-list-vertical":t.labelOrientation==="vertical","p-metergroup-label-list-horizontal":t.labelOrientation==="horizontal"}],label:"p-metergroup-label",labelIcon:"p-metergroup-label-icon",labelMarker:"p-metergroup-label-marker",labelText:"p-metergroup-label-text"},wt=(()=>{class t extends at{name="metergroup";theme=hr;classes=yr;static \u0275fac=(()=>{let e;return function(n){return(e||(e=ke(t)))(n||t)}})();static \u0275prov=z({token:t,factory:t.\u0275fac})}return t})(),Cr=(()=>{class t{value=null;labelPosition="end";labelOrientation="horizontal";min;max;iconTemplate;get labelClass(){return{"p-metergroup-label-list p-component":!0,"p-metergroup-label-list-vertical":this.labelOrientation==="vertical","p-metergroup-label-list-horizontal":this.labelOrientation==="horizontal"}}parentInstance=Ie(Le(()=>je));static \u0275fac=function(i){return new(i||t)};static \u0275cmp=E({type:t,selectors:[["p-meterGroupLabel"],["p-metergrouplabel"]],inputs:{value:"value",labelPosition:"labelPosition",labelOrientation:"labelOrientation",min:"min",max:"max",iconTemplate:"iconTemplate"},decls:2,vars:3,consts:[[3,"ngClass"],["class","p-metergroup-label",4,"ngFor","ngForOf","ngForTrackBy"],[1,"p-metergroup-label"],[4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"p-metergroup-label-text"],[3,"class","ngClass","ngStyle",4,"ngIf"],["class","p-metergroup-label-marker",3,"ngStyle",4,"ngIf"],[3,"ngClass","ngStyle"],[1,"p-metergroup-label-marker",3,"ngStyle"]],template:function(i,n){i&1&&(l(0,"ol",0),b(1,er,5,8,"li",1),o()),i&2&&(s("ngClass",n.labelClass),a(),s("ngForOf",n.value)("ngForTrackBy",n.parentInstance.trackByFn))},dependencies:[O,M,Be,R,$e,De,Ge],encapsulation:2})}return t})(),je=(()=>{class t extends st{value;min=0;max=100;orientation="horizontal";labelPosition="end";labelOrientation="horizontal";style;styleClass;get vertical(){return this.orientation==="vertical"}get containerClass(){return{"p-metergroup p-component":!0,"p-metergroup-horizontal":this.orientation==="horizontal","p-metergroup-vertical":this.orientation==="vertical"}}labelTemplate;meterTemplate;endTemplate;startTemplate;iconTemplate;templates;_labelTemplate;_meterTemplate;_endTemplate;_startTemplate;_iconTemplate;_componentStyle=Ie(wt);container;ngAfterViewInit(){super.ngAfterViewInit();let e=this.container.nativeElement,i=lt(e);this.vertical&&(e.style.height=i+"px")}ngAfterContentInit(){this.templates?.forEach(e=>{switch(e.getType()){case"label":this._labelTemplate=e.template;break;case"meter":this._meterTemplate=e.template;break;case"icon":this._iconTemplate=e.template;break;case"start":this._startTemplate=e.template;break;case"end":this._endTemplate=e.template;break}})}percent(e=0){let i=(e-this.min)/(this.max-this.min)*100;return Math.round(Math.max(0,Math.min(100,i)))}percentValue(e){return this.percent(e)+"%"}meterStyle(e){return{backgroundColor:e.color,width:this.orientation==="horizontal"&&this.percentValue(e.value),height:this.orientation==="vertical"&&this.percentValue(e.value)}}totalPercent(){return this.percent(this.value.reduce((e,i)=>e+i.value,0))}percentages(){let e=0,i=[];return this.value.forEach(n=>{e+=n.value,i.push(e)}),i}trackByFn(e){return e}static \u0275fac=(()=>{let e;return function(n){return(e||(e=ke(t)))(n||t)}})();static \u0275cmp=E({type:t,selectors:[["p-meterGroup"],["p-metergroup"],["p-meter-group"]],contentQueries:function(i,n,c){if(i&1&&(P(c,tr,4),P(c,rr,4),P(c,ir,4),P(c,nr,4),P(c,or,4),P(c,J,4)),i&2){let f;x(f=S())&&(n.labelTemplate=f.first),x(f=S())&&(n.meterTemplate=f.first),x(f=S())&&(n.endTemplate=f.first),x(f=S())&&(n.startTemplate=f.first),x(f=S())&&(n.iconTemplate=f.first),x(f=S())&&(n.templates=f)}},viewQuery:function(i,n){if(i&1&&A(lr,5,Ae),i&2){let c;x(c=S())&&(n.container=c.first)}},inputs:{value:"value",min:"min",max:"max",orientation:"orientation",labelPosition:"labelPosition",labelOrientation:"labelOrientation",style:"style",styleClass:"styleClass"},features:[H([wt]),He],decls:8,vars:24,consts:[["container",""],[3,"ngClass","ngStyle"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"p-metergroup-meters"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"value","labelPosition","labelOrientation","min","max","iconTemplate",4,"ngIf"],[3,"value","labelPosition","labelOrientation","min","max","iconTemplate"],[4,"ngIf"],[1,"p-metergroup-meter",3,"ngStyle"]],template:function(i,n){i&1&&(l(0,"div",1,0),b(2,mr,2,7)(3,ur,1,0,"ng-container",2),l(4,"div",3),b(5,gr,3,9,"ng-container",4),o(),b(6,fr,1,0,"ng-container",2)(7,vr,2,7),o()),i&2&&(Me(n.styleClass),s("ngClass",n.containerClass)("ngStyle",n.style),Ue("role","meter")("aria-valuemin",n.min)("aria-valuemax",n.max)("aria-valuenow",n.totalPercent()),a(2),Oe(n.labelPosition==="start"?2:-1),a(),s("ngTemplateOutlet",n.startTemplate||n._startTemplate)("ngTemplateOutletContext",k(16,we,n.value,n.totalPercent(),n.percentages())),a(2),s("ngForOf",n.value)("ngForTrackBy",n.trackByFn),a(),s("ngTemplateOutlet",n.endTemplate||n._endTemplate)("ngTemplateOutletContext",k(20,we,n.value,n.totalPercent(),n.percentages())),a(),Oe(n.labelPosition==="end"?7:-1))},dependencies:[O,M,Be,R,$e,De,Cr,Ge],encapsulation:2,changeDetection:0})}return t})()});function Mr(t,r){t&1&&(l(0,"tr")(1,"th"),p(2,"Codes"),o(),l(3,"th"),p(4,"Noms"),o(),l(5,"th"),p(6,"R\xE9ferences"),o(),l(7,"th"),p(8,"Fournisseurs"),o(),l(9,"th"),p(10,"Prix unitaire"),o(),l(11,"th"),p(12,"Quantit\xE9s"),o(),m(13,"th"),o())}function Or(t,r){if(t&1){let e=V();l(0,"tr")(1,"td"),p(2),o(),l(3,"td",33),m(4,"i",34),p(5),o(),l(6,"td"),p(7),o(),l(8,"td")(9,"p-button",35),_("click",function(){let n=v(e).$implicit,c=d(2);return h(c.showDialog(n.name))}),o()(),l(10,"td")(11,"span",36),p(12,"FCFA "),o(),p(13),o(),l(14,"td"),p(15),o(),l(16,"td")(17,"div",37)(18,"div")(19,"p-button",38),_("onClick",function(){let n=v(e).$implicit,c=d(2);return h(c.goToDetails(n))}),o()(),l(20,"div")(21,"p-button",39),_("click",function(n){let c=v(e).$implicit,f=d(2);return h(f.trash(n,c))}),o()()()()()}if(t&2){let e=r.$implicit;a(2),I("#",e.code,""),a(2),s("ngClass",k(8,kr,e.quantity<10,e.quantity>=10&&e.quantity<30,e.quantity>=30)),a(),I("",e.name," "),a(2),I("#",e.reference,""),a(6),I(" ",e.price," "),a(2),Q(e.quantity),a(4),s("outlined",!0),a(2),s("outlined",!0)}}function qr(t,r){if(t&1){let e=V();l(0,"div")(1,"div",11)(2,"div",12)(3,"div",13),m(4,"img",14),o(),l(5,"div",15)(6,"div")(7,"span",16),p(8,"VALEUR TOTALE"),o()(),l(9,"div")(10,"span",17),p(11),Ye(12,"number"),o()()()(),l(13,"div",18)(14,"div",19)(15,"span",20),p(16),o(),l(17,"span"),p(18,"Produits"),o()(),m(19,"p-metergroup",21),o()(),l(20,"div",22)(21,"div",23)(22,"div",24)(23,"div",25)(24,"p-iconfield"),m(25,"p-inputicon",26),l(26,"input",27),_("input",function(n){v(e);let c=d();return h(c.applyFilter(n))}),o()()()(),l(27,"div",28)(28,"p-button",29),_("click",function(){v(e);let n=d();return h(n.goToAddProduct())}),o(),l(29,"p-button",30),_("onClick",function(){v(e);let n=d();return h(n.exportCSV())}),o()()(),l(30,"div",31)(31,"p-table",32,3),b(33,Mr,14,0,"ng-template",null,0,B)(35,Or,22,12,"ng-template",null,4,B),o()()()()}if(t&2){let e=d();a(11),I(" FCFA ",Ze(12,12,e.getTotalPurchasePrice(),"1.0-0")," "),a(5),Q(e.products.length),a(3),N(y(15,Er)),s("value",e.value)("max",100),a(12),s("value",e.products)("globalFilterFields",y(16,Fr))("tableStyle",y(17,Pr))("paginator",!0)("rows",40)("rowsPerPageOptions",y(18,Ir))}}function Nr(t,r){t&1&&(l(0,"div",40),m(1,"img",41),o())}function Vr(t,r){t&1&&(l(0,"tr")(1,"th"),p(2,"Nom"),o(),l(3,"th"),p(4,"Prix"),o()())}function Br(t,r){if(t&1&&(l(0,"tr")(1,"td"),p(2),o(),l(3,"td"),p(4),o()()),t&2){let e=r.$implicit;a(2),Q(e.supplierName),a(2),I("FCFA ",e.supplierPrice,"")}}function Dr(t,r){if(t&1){let e=V();l(0,"p-fluid")(1,"form",42),_("ngSubmit",function(){v(e);let n=d();return h(n.onSubmit())}),l(2,"div",43)(3,"div",44)(4,"label",45),p(5,"Code"),o(),m(6,"input",46),o(),l(7,"div",44)(8,"label",47),p(9,"R\xE9f\xE9rence"),o(),m(10,"input",48),o()(),l(11,"div",43)(12,"div",44)(13,"label",49),p(14,"Designation"),o(),m(15,"input",50),o(),l(16,"div",44)(17,"label",51),p(18,"Cat\xE9gorie"),o(),m(19,"p-select",52),o()(),l(20,"div",43)(21,"div",44)(22,"label",53),p(23,"Quantit\xE9 en stock"),o(),m(24,"p-inputnumber",54),o(),l(25,"div",44)(26,"label",55),p(27,"Seuil de r\xE9approvisionnement"),o(),m(28,"p-inputnumber",56),o()(),l(29,"div",43)(30,"div",44)(31,"label",57),p(32,"Poids(G)"),o(),m(33,"p-inputnumber",58),o(),l(34,"div",44)(35,"label",59),p(36,"Marque"),o(),m(37,"input",60),o()(),l(38,"div",43)(39,"div",44)(40,"label",61),p(41,"Nom du fournisseur"),o(),m(42,"p-select",62),o()()()()}if(t&2){let e=d();a(),s("formGroup",e.productForm),a(5),s("ngClass",g(12,w,e.erreurInput&&e.productForm.controls.code.errors)),a(4),s("ngClass",g(14,w,e.erreurInput&&e.productForm.controls.reference.errors)),a(5),s("ngClass",g(16,w,e.erreurInput&&e.productForm.controls.name.errors)),a(4),s("options",e.categories)("ngClass",g(18,w,e.erreurInput&&e.productForm.controls.category.errors)),a(5),s("ngClass",g(20,w,e.erreurInput&&e.productForm.controls.quantity.errors)),a(4),s("ngClass",g(22,w,e.erreurInput&&e.productForm.controls.minimum_stock.errors)),a(5),s("ngClass",g(24,w,e.erreurInput&&e.productForm.controls.weight.errors)),a(4),s("ngClass",g(26,w,e.erreurInput&&e.productForm.controls.brand.errors)),a(5),s("options",e.suppliers)("ngClass",g(28,w,e.erreurInput&&e.productForm.controls.supplier.errors))}}function $r(t,r){if(t&1){let e=V();l(0,"p-button",63),_("click",function(){v(e);let n=d();return h(n.clearForm())}),o(),l(1,"p-button",64),_("click",function(){v(e);let n=d();return h(n.onSubmit())}),o()}if(t&2){let e=d();a(),s("loading",e.loading)}}var xr,Sr,Ft,Tr,wr,Er,Fr,Pr,Ir,kr,w,Ee,Pt=G(()=>{"use strict";bt();q();Et();X();ue();Nt();Ot();gt();ut();Se();ge();se();be();ye();D();ze();ot();X();se();bt();q();ue();gt();ut();Se();ge();be();ye();xr=["dt"],Sr=()=>({width:"45vw","max-height":"50vh","overflow-y":"auto"}),Ft=()=>({"1199px":"75vw","575px":"90vw"}),Tr=()=>({"min-width":"max-content"}),wr=()=>({width:"50vw","max-height":"90vh","overflow-y":"auto"}),Er=()=>({width:"100%"}),Fr=()=>["name","code","reference","price","quantity"],Pr=()=>({"min-width":"75rem"}),Ir=()=>[10,20,40,60],kr=(t,r,e)=>({red:t,orange:r,green:e}),w=t=>({"ng-invalid ng-dirty":t});Ee=class t{constructor(r,e,i,n,c){this.productService=r;this.router=e;this.messageService=i;this.confirmationService=n;this.fb=c;this.productForm=this.fb.group({code:["",u.required],reference:["",u.required],name:["",u.required],category:[null,u.required],quantity:[null,[u.required,u.min(1)]],minimum_stock:[null,[u.required,u.min(1)]],weight:[null,[u.min(0)]],brand:[""],supplier:[null,u.required]})}products=[];value=[];articlesDialog=!1;articlesDetailsDialog=!1;selectedSupplierProducts;dt;selectedProduct;categories=[{name:"Boissons",code:"0"},{name:"\xC9picerie",code:"1"},{name:"Produits Surgel\xE9s",code:"2"},{name:"Boulangerie & P\xE2tisserie",code:"3"},{name:"Produits d\u2019Hygi\xE8ne",code:"4"},{name:"Entretien & Nettoyage",code:"5"}];suppliers=[];erreurInput=!1;responseError;loading=!1;productForm;product={};ngOnInit(){this.productService.getAllProducts().subscribe({next:r=>{this.products=r,console.log(this.products),this.updateStockProportions()},error:r=>{this.showError(r.error.error)}})}getTotalPurchasePrice(){return this.products.reduce((r,e)=>r+e.price*e.quantity,0)}exportCSV(){this.dt.exportCSV()}showDialog(r){this.productService.get_products_supplied_by_product(r).subscribe({next:e=>{this.selectedSupplierProducts=e},error:e=>{this.showError(e.error.error)}}),this.articlesDialog=!0}updateStockProportions(){let r=this.products.length,e=this.products.filter(c=>c.quantity<10).length/r*100,i=this.products.filter(c=>c.quantity>=10&&c.quantity<30).length/r*100,n=this.products.filter(c=>c.quantity>=30).length/r*100;this.value=[{label:"En Stock",color:"#34d399",value:n},{label:"Stock bas",color:"#fbbf24",value:i},{label:"Stock \xE9puis\xE9",color:"#9A031E",value:e}]}trash(r,e){this.confirmationService.confirm({target:r.target,message:"Voulez-vous supprimer ce fournisseur ?",header:"Supprimer",icon:"fa-solid fa-circle-info",rejectLabel:"annuler",rejectButtonProps:{label:"Annuler",severity:"secondary",outlined:!0},acceptButtonProps:{label:"Confirmer",severity:"danger"},accept:()=>{this.productService.deleteProduct(e.id).subscribe({next:()=>{this.products=this.products.filter(i=>i.id!==e.id),this.showSuccess("Suppression r\xE9ussie")},error:()=>{this.showError("\xC9chec de la suppression")}})},reject:()=>{this.showError("supprission annul\xE9")}})}goToDetails(r){this.product=r,this.productService.get_products_supplied_by_product(r.name).subscribe({next:e=>{this.suppliers=e,this.productForm=this.fb.group({code:[r.code,u.required],reference:[r.reference,u.required],name:[r.name,u.required],category:[this.categories[this.mapCategries(e.category)],u.required],quantity:[r.quantity,[u.required,u.min(1)]],minimum_stock:[r.minimumStock,[u.required,u.min(1)]],weight:[r.weight,[u.min(0)]],brand:[r.brand],supplier:[this.suppliers[this.mapSupplier(e.supplier)],u.required]}),this.articlesDetailsDialog=!0},error:e=>{this.showError(e.error.error)}})}mapCategries(r){let e=this.categories.find(i=>i.name===r);return e?parseInt(e.code,10):0}mapSupplier(r){let e=this.suppliers.find(i=>i.name===r);return e?this.suppliers.indexOf(e):0}applyFilter(r){let e=r.target;e&&this.dt.filterGlobal(e.value,"contains")}goToAddProduct(){this.router.navigate(["products/addproduct"])}showSuccess(r){this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:r})}showError(r){this.messageService.add({severity:"error",summary:"Erreur",detail:r})}clearSelectedSuppliers(){this.selectedSupplierProducts=[]}onSubmit(){if(this.loading=!0,this.productForm.valid){let r=Fe(Fe({},this.product),this.productForm.value);this.productService.updateProduct(r,this.product.id).subscribe({next:e=>{this.showSuccess("Produit mis \xE0 jour avec succ\xE8s !"),this.loading=!1;let i=this.products.findIndex(n=>n.id===this.product.id);i!==-1&&(this.products[i]=e,this.products=[...this.products])},error:e=>{this.showError(e.error.error),this.loading=!1}})}else this.erreurInput=!0,this.loading=!1,this.showError("Veuillez remplir tous les champs obligatoires.")}clearForm(){this.productForm.reset()}static \u0275fac=function(e){return new(e||t)(C($),C(U),C(K),C(W),C(oe))};static \u0275cmp=E({type:t,selectors:[["app-productslist"]],viewQuery:function(e,i){if(e&1&&A(xr,5),e&2){let n;x(n=S())&&(i.dt=n.first)}},features:[H([W])],decls:13,vars:25,consts:[["header",""],["content",""],["footer",""],["dt",""],["body",""],[4,"ngIf"],["style",`
        display: flex;
        align-items: center;
        justify-content: center;
        height: 89vh;
    `,4,"ngIf"],["header","Les articles",3,"visibleChange","onHide","visible","modal","breakpoints","draggable","resizable"],["selectionMode","single",3,"value","tableStyle"],["pTemplate","body"],[3,"visibleChange","onHide","header","visible","modal","breakpoints","resizable"],[1,"card","w-full","flex","gap-12"],[1,"flex","gap-4",2,"padding-right","2.6rem"],[1,""],["src","/icons/Cash.svg","alt","",2,"width","3.5rem"],[1,"mt","flex","flex-col","gap-1"],[1,"text-sm"],[1,"text-xl","font-bold"],[1,"flex","flex-col","gap-1"],[1,"flex","gap-2"],[1,"font-bold","text-sm"],[3,"value","max"],[1,"card","w-full"],[1,"flex","justify-between","gap-4","mb-4"],[1,"w-full"],[1,"flex","items-center","justify-between"],["styleClass","pi pi-search"],["pInputText","","type","text","placeholder","Rechercher un produit...",3,"input"],[1,"flex","gap-4"],["label","Ajouter","icon","fa-solid fa-plus","severity","contrast",3,"click"],["label","Exporter","icon","pi pi-upload","severity","secondary",3,"onClick"],[1,"mt-4"],["selectionMode","single","dataKey","id",3,"value","globalFilterFields","tableStyle","paginator","rows","rowsPerPageOptions"],[1,"name-td"],[1,"fa-solid","fa-circle",3,"ngClass"],["label","Voir les fournisseurs","severity","info","text","",3,"click"],[2,"font-weight","500","color","rgb(47, 47, 47)"],[2,"display","flex","gap","1rem"],["label","","severity","info","icon","fa-solid fa-pencil",3,"onClick","outlined"],["label","","severity","danger","icon","fa-solid fa-trash-can",3,"click","outlined"],[2,"display","flex","align-items","center","justify-content","center","height","89vh"],["src","img/No data-rafiki.svg","alt","",2,"width","35rem"],[1,"card","flex","flex-col","gap-6","w-full",3,"ngSubmit","formGroup"],[1,"flex","flex-col","md:flex-row","gap-6"],[1,"flex","flex-wrap","gap-2","w-full"],["for","code"],["pInputText","","type","text","id","code","name","code","formControlName","code","required","",3,"ngClass"],["for","reference"],["pInputText","","type","text","id","reference","name","reference","formControlName","reference","required","",3,"ngClass"],["for","designation"],["pInputText","","type","text","id","name","name","name","formControlName","name","required","",3,"ngClass"],["for","category"],["formControlName","category","optionLabel","name","required","",1,"w-full",3,"options","ngClass"],["for","quantity"],["type","text","id","quantity","name","quantity","formControlName","quantity","showButtons","","mode","decimal","required","",3,"ngClass"],["for","reorderThreshold"],["type","text","id","minimum_stock","name","minimum_stock","formControlName","minimum_stock","required","","showButtons","","mode","decimal",3,"ngClass"],["for","weight"],["type","text","id","weight","name","weight","formControlName","weight","showButtons","","mode","decimal",3,"ngClass"],["for","brand"],["pInputText","","type","text","id","brand","name","brand","formControlName","brand",3,"ngClass"],["for","supplier"],["formControlName","supplier","optionLabel","supplierName","required","",1,"w-full",3,"options","ngClass"],["label","Vider","icon","pi pi-times","severity","danger","outlined","",3,"click"],["type","submit","label","Enregister","icon","pi pi-save","severity","contrast",3,"click","loading"]],template:function(e,i){if(e&1){let n=V();b(0,qr,37,19,"div",5)(1,Nr,2,0,"div",6),m(2,"p-confirmdialog"),l(3,"p-dialog",7),Ve("visibleChange",function(f){return v(n),Ne(i.articlesDialog,f)||(i.articlesDialog=f),h(f)}),_("onHide",function(){return v(n),h(i.clearSelectedSuppliers())}),l(4,"p-table",8),b(5,Vr,5,0,"ng-template",null,0,B)(7,Br,5,2,"ng-template",9),o()(),l(8,"p-dialog",10),Ve("visibleChange",function(f){return v(n),Ne(i.articlesDetailsDialog,f)||(i.articlesDetailsDialog=f),h(f)}),_("onHide",function(){return v(n),h(i.clearSelectedSuppliers())}),b(9,Dr,43,30,"ng-template",null,1,B)(11,$r,2,1,"ng-template",null,2,B),o()}e&2&&(s("ngIf",i.products.length>0),a(),s("ngIf",i.products.length<=0),a(2),N(y(20,Sr)),qe("visible",i.articlesDialog),s("modal",!0)("breakpoints",y(21,Ft))("draggable",!0)("resizable",!1),a(),s("value",i.selectedSupplierProducts)("tableStyle",y(22,Tr)),a(4),N(y(23,wr)),We("header","Details du produit ",i.product.name,""),qe("visible",i.articlesDetailsDialog),s("modal",!0)("breakpoints",y(24,Ft))("resizable",!1)("modal",!0))},dependencies:[je,_t,ft,J,O,M,R,et,me,pe,yt,vt,dt,ct,mt,pt,xe,Ce,de,ce,_e,fe,he,ve,le,te,Y,Z,ee,ne,ae,re,ie],styles:["td[_ngcontent-%COMP%]{max-width:max-content!important}.name-td[_ngcontent-%COMP%]{max-width:300px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.name-td[_ngcontent-%COMP%]   .fa-circle[_ngcontent-%COMP%]{font-size:.5rem;margin-right:.5rem}.name-td[_ngcontent-%COMP%]   .red[_ngcontent-%COMP%]{color:#99031e}.name-td[_ngcontent-%COMP%]   .orange[_ngcontent-%COMP%]{color:#fbbf24}.name-td[_ngcontent-%COMP%]   .green[_ngcontent-%COMP%]{color:#34d399}"]})}});var Wi,Gr=G(()=>{Tt();Pt();Wi=[{path:"addproduct",component:Te},{path:"productslist",component:Ee}]});Gr();export{Wi as default};
