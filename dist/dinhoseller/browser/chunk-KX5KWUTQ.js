import{a as oe,b as je}from"./chunk-CVBMZPTJ.js";import{a as ie,b as re,c as ne,d as Be,f as $e,i as Le,j as Xe}from"./chunk-J743F2QU.js";import{h as Me,i as Ye,j as Te,k as Ie,l as Pe,m as Ve,n as Ge,o as Ae,p as te,q as ke,r as ye,s as Re,v as qe,w as De}from"./chunk-PHNKNGKI.js";import{$b as J,Da as k,Ea as g,Ga as R,Ha as q,Ja as D,Ka as B,La as L,Ma as j,Na as O,Oa as W,Pa as Z,Qa as H,Ra as z,Sa as Q,Ta as K,ac as U,bc as Y,ia as G,jc as $,kc as X,l as V,lc as ee,ma as A,pa as Ne,s as Fe,sa as Se}from"./chunk-MJGBYBNV.js";import{k as N,l as M,m as T,r as I,x as P}from"./chunk-GCAJPEYL.js";import{$a as E,Bb as S,Eb as c,Fb as d,Jb as Ce,Lb as de,Mb as ce,Nb as fe,Qa as a,Rb as p,Sb as F,Tb as _e,Va as v,Vb as ge,Wb as he,Xb as ve,Yb as we,Zb as y,_b as b,a as ue,b as be,d as me,da as f,ea as _,eb as x,jc as C,mb as s,pb as w,vb as n,wb as t,xb as m,xc as Ee}from"./chunk-PHRQPCRV.js";function mt(l,r){if(l&1){let e=S();n(0,"i",42),c("click",function(){f(e);let o=d().index,u=d();return _(u.removeProduct(o))}),t()}}function dt(l,r){if(l&1){let e=S();n(0,"div",37)(1,"div",9)(2,"input",38),c("input",function(){let o=f(e).index,u=d();return _(u.addProductIfNeeded(o))}),t()(),n(3,"div",39)(4,"input",40),c("input",function(){let o=f(e).index,u=d();return _(u.addProductIfNeeded(o))}),t(),x(5,mt,1,0,"i",41),t()()}if(l&2){let e=r.index,i=d();s("formGroupName",e),a(5),s("ngIf",i.productsSupplied.length>1)}}var ut,le,pe,Oe=me(()=>{"use strict";P();K();Y();ee();ye();ne();Ee();K();Se();je();Fe();P();ee();Y();ne();ut=()=>({height:"100%",width:"3.5rem"}),le=l=>({"ng-invalid ng-dirty":l});pe=class l{constructor(r,e,i,o){this.fb=r;this.messageService=e;this.supplierService=i;this.router=o;this.supplierForm=this.fb.group({name:["",g.required],status:[null,g.required],address:[""],city:[""],postalCode:[""],country:[""],phone:["",g.required],email:["",[g.email]],website:[""],preferredPaymentMethod:[null,g.required],productsSupplied:this.fb.array([this.createProductFormGroup()])})}supplierForm;erreurInput=!1;responseError;loading=!1;status=[{name:"Active",code:"0"},{name:"Inactive",code:"1"}];preferredPaymentMethod=[{name:"Orange Money",code:"OM"},{name:"MTN Money",code:"MTN"},{name:"Virement",code:"VIR"},{name:"Esp\xE8ce",code:"ESP"},{name:"Ch\xE8que",code:"CHQ"}];countries=[{name:"Afrique du Sud",code:"ZA"},{name:"Alg\xE9rie",code:"DZ"},{name:"Angola",code:"AO"},{name:"B\xE9nin",code:"BJ"},{name:"Botswana",code:"BW"},{name:"Burkina Faso",code:"BF"},{name:"Burundi",code:"BI"},{name:"Cap-Vert",code:"CV"},{name:"Cameroun",code:"CM"},{name:"R\xE9publique centrafricaine",code:"CF"},{name:"Comores",code:"KM"},{name:"R\xE9publique du Congo",code:"CG"},{name:"R\xE9publique d\xE9mocratique du Congo",code:"CD"},{name:"Djibouti",code:"DJ"},{name:"\xC9gypte",code:"EG"},{name:"Guin\xE9e \xE9quatoriale",code:"GQ"},{name:"\xC9rythr\xE9e",code:"ER"},{name:"Eswatini",code:"SZ"},{name:"\xC9thiopie",code:"ET"},{name:"Gabon",code:"GA"},{name:"Gambie",code:"GM"},{name:"Ghana",code:"GH"},{name:"Guin\xE9e",code:"GN"},{name:"Guin\xE9e-Bissau",code:"GW"},{name:"C\xF4te d'Ivoire",code:"CI"},{name:"Kenya",code:"KE"},{name:"Lesotho",code:"LS"},{name:"Liberia",code:"LR"},{name:"Libye",code:"LY"},{name:"Madagascar",code:"MG"},{name:"Malawi",code:"MW"},{name:"Mali",code:"ML"},{name:"Mauritanie",code:"MR"},{name:"Maurice",code:"MU"},{name:"Maroc",code:"MA"},{name:"Mozambique",code:"MZ"},{name:"Namibie",code:"NA"},{name:"Niger",code:"NE"},{name:"Nigeria",code:"NG"},{name:"Rwanda",code:"RW"},{name:"Sao Tom\xE9-et-Principe",code:"ST"},{name:"S\xE9n\xE9gal",code:"SN"},{name:"Seychelles",code:"SC"},{name:"Sierra Leone",code:"SL"},{name:"Somalie",code:"SO"},{name:"Soudan",code:"SD"},{name:"Soudan du Sud",code:"SS"},{name:"Tanzanie",code:"TZ"},{name:"Togo",code:"TG"},{name:"Tunisie",code:"TN"},{name:"Ouganda",code:"UG"},{name:"Zambie",code:"ZM"},{name:"Zimbabwe",code:"ZW"}];get productsSupplied(){return this.supplierForm.get("productsSupplied")}createProductFormGroup(){return this.fb.group({productName:[""],price:["",[g.min(0)]]})}addProductIfNeeded(r){let e=this.productsSupplied.at(r);if(e.get("productName")?.value!==""||e.get("price")?.value!==""){let i=this.productsSupplied.length-1;(this.productsSupplied.at(i).get("productName")?.value!==""||this.productsSupplied.at(i).get("price")?.value!=="")&&this.productsSupplied.push(this.createProductFormGroup())}}removeProduct(r){this.productsSupplied.length>1&&this.productsSupplied.removeAt(r)}onSubmit(){if(this.supplierForm.valid){let r=this.supplierForm.get("name")?.value,e=this.supplierForm.get("status")?.value.name,i=this.supplierForm.get("address")?.value,o=this.supplierForm.get("city")?.value,u=this.supplierForm.get("postalCode")?.value,h=this.supplierForm.get("country")?.value,He=this.supplierForm.get("phone")?.value,ze=this.supplierForm.get("email")?.value,Qe=this.supplierForm.get("website")?.value,Ke=this.supplierForm.get("preferredPaymentMethod")?.value.name,Je=this.productsSupplied.value,Ue={name:r,status:e,address:i,city:o,postalCode:u,country:h,phone:He,email:ze,website:Qe,preferredPaymentMethod:Ke,productsSupplied:Je};this.loading=!0,this.supplierService.addSupplier(Ue).subscribe({next:xe=>{this.showSuccess("Fournisseur ajout\xE9 avec succ\xE8s !"),this.supplierForm.reset(),this.productsSupplied.clear(),this.productsSupplied.push(this.createProductFormGroup()),this.loading=!1},error:xe=>{this.showError(xe.error.error),this.loading=!1}})}else this.erreurInput=!0,console.log("erreur dans le formulaire"),this.showError("Veuillez remplir tous les champs obligatoires.")}showSuccess(r){this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:r})}showError(r){this.messageService.add({severity:"error",summary:"Erreur",detail:r})}clearForm(){this.supplierForm.reset(),this.productsSupplied.clear(),this.productsSupplied.push(this.createProductFormGroup())}goToSupplierList(){this.router.navigate(["suppliers/list-suppliers"])}static \u0275fac=function(e){return new(e||l)(v(H),v(A),v(oe),v(V))};static \u0275cmp=E({type:l,selectors:[["app-addsupplier"]],decls:70,vars:21,consts:[[1,""],[1,"flex","gap-4","mb-12"],["icon","pi pi-arrow-left","severity","contrast",1,"text-xl",3,"click"],[1,"text-xl"],[1,"text-2xl","font-bold","text-primary"],[1,"w-full","mt-4",3,"ngSubmit","formGroup"],[1,"w-full","mt-4"],[1,"card","mt-6"],[1,"flex","flex-col","md:flex-row","gap-6","w-full"],[1,"flex","flex-wrap","gap-2","w-full"],["for","name"],["pInputText","","type","text","id","name","name","name","formControlName","name","required","",3,"ngClass"],["for","status"],["formControlName","status","optionLabel","name","required","",1,"w-full",3,"options","ngClass"],[1,"flex","flex-col","md:flex-row","gap-6","mt-8","w-full"],["for","address"],["pInputText","","type","text","id","address","name","address","formControlName","address"],["for","city"],["pInputText","","type","text","id","city","name","city","formControlName","city"],["for","postalCode"],["pInputText","","type","text","id","postalCode","name","postalCode","formControlName","postalCode","required",""],["for","country"],["formControlName","country","optionLabel","name",1,"w-full",3,"options"],["for","phone"],["pInputText","","type","text","id","phone","name","phone","formControlName","phone","required","",3,"ngClass"],["for","email"],["pInputText","","type","email","id","email","name","email","formControlName","email"],["for","website"],["pInputText","","type","url","id","website","name","website","formControlName","website"],["for","preferredPaymentMethod"],["formControlName","preferredPaymentMethod","optionLabel","name","required","",1,"w-full",3,"options","ngClass"],[1,"card"],["id","productsSupplied","formArrayName","productsSupplied",1,""],["class","flex flex-col md:flex-row gap-6 m-4 w-full",3,"formGroupName",4,"ngFor","ngForOf"],[1,"flex","flex-wrap","gap-4","mb-6","mt-6"],["label","Vider","icon","pi pi-times","severity","danger","outlined","",3,"click"],["type","submit","label","Enregister","icon","pi pi-save","severity","contrast",3,"loading"],[1,"flex","flex-col","md:flex-row","gap-6","m-4","w-full",3,"formGroupName"],["pInputText","","type","text","placeholder","Nom du produit","formControlName","productName",3,"input"],[1,"flex","gap-2","w-full",2,"align-items","center"],["pInputText","","type","number","placeholder","Prix","formControlName","price",3,"input"],["style",`
                                    margin-left: 1rem;
                                    cursor: pointer;
                                    color: red;
                                `,"class","fa-solid fa-xmark",3,"click",4,"ngIf"],[1,"fa-solid","fa-xmark",2,"margin-left","1rem","cursor","pointer","color","red",3,"click"]],template:function(e,i){e&1&&(n(0,"p-fluid")(1,"div",0)(2,"div",1)(3,"div")(4,"p-button",2),c("click",function(){return i.goToSupplierList()}),t()(),n(5,"div",0)(6,"div")(7,"span",3),p(8,"Retourner \xE0 la liste des fournisseurs"),t()(),n(9,"div")(10,"span",4),p(11,"Enregistrer un fournisseur"),t()()()()(),n(12,"form",5),c("ngSubmit",function(){return i.onSubmit()}),n(13,"div",6)(14,"h4"),p(15,"Informations du fournisseur"),t(),n(16,"div",7)(17,"div",8)(18,"div",9)(19,"label",10),p(20,"Nom"),t(),m(21,"input",11),t(),n(22,"div",9)(23,"label",12),p(24,"Statut"),t(),m(25,"p-select",13),t()(),n(26,"div",14)(27,"div",9)(28,"label",15),p(29,"Adresse"),t(),m(30,"input",16),t(),n(31,"div",9)(32,"label",17),p(33,"Ville"),t(),m(34,"input",18),t()(),n(35,"div",14)(36,"div",9)(37,"label",19),p(38,"Code Postal"),t(),m(39,"input",20),t(),n(40,"div",9)(41,"label",21),p(42,"Pays"),t(),m(43,"p-select",22),t()(),n(44,"div",14)(45,"div",9)(46,"label",23),p(47,"T\xE9l\xE9phone"),t(),m(48,"input",24),t(),n(49,"div",9)(50,"label",25),p(51,"Email"),t(),m(52,"input",26),t()(),n(53,"div",14)(54,"div",9)(55,"label",27),p(56,"Site Web"),t(),m(57,"input",28),t(),n(58,"div",9)(59,"label",29),p(60,"M\xE9thode de paiement pr\xE9f\xE9r\xE9e"),t(),m(61,"p-select",30),t()()(),n(62,"h4"),p(63,"Produits fournis"),t(),n(64,"div",31)(65,"div",32),x(66,dt,6,2,"div",33),t()()(),n(67,"div",34)(68,"p-button",35),c("click",function(){return i.clearForm()}),t(),m(69,"p-button",36),t()()()),e&2&&(a(4),w(y(12,ut)),a(8),s("formGroup",i.supplierForm),a(9),s("ngClass",b(13,le,i.erreurInput&&i.supplierForm.controls.name.errors)),a(4),s("options",i.status)("ngClass",b(15,le,i.erreurInput&&i.supplierForm.controls.status.errors)),a(18),s("options",i.countries),a(5),s("ngClass",b(17,le,i.erreurInput&&i.supplierForm.controls.phone.errors)),a(13),s("options",i.preferredPaymentMethod)("ngClass",b(19,le,i.erreurInput&&i.supplierForm.controls.preferredPaymentMethod.errors)),a(5),s("ngForOf",i.productsSupplied.controls),a(3),s("loading",i.loading))},dependencies:[I,N,M,T,X,$,U,J,Q,D,k,B,R,q,Z,L,W,j,O,z,te,re,ie],encapsulation:2})}});function xt(l,r){l&1&&(n(0,"tr")(1,"th"),p(2,"Noms"),t(),n(3,"th"),p(4,"status"),t(),n(5,"th"),p(6,"Articles"),t(),n(7,"th"),p(8,"T\xE9l\xE9phone"),t(),m(9,"th"),t())}function bt(l,r){if(l&1){let e=S();n(0,"tr")(1,"td",23),p(2),t(),n(3,"td"),p(4),t(),n(5,"td",24)(6,"p-button",25),c("click",function(){let o=f(e).$implicit,u=d(2);return _(u.showDialog(o.name))}),t()(),n(7,"td"),p(8),t(),n(9,"td")(10,"div",26)(11,"div")(12,"p-button",27),c("onClick",function(){let o=f(e).$implicit,u=d(2);return _(u.goToDetails(o))}),t()(),n(13,"div")(14,"p-button",28),c("click",function(o){let u=f(e).$implicit,h=d(2);return _(h.trash(o,u))}),t()()()()()}if(l&2){let e=r.$implicit;a(2),_e(" ",e.name," "),a(2),F(e.status),a(4),F(e.phone),a(4),s("outlined",!0),a(2),s("outlined",!0)}}function Ct(l,r){if(l&1){let e=S();n(0,"div",12)(1,"div",13)(2,"div",14)(3,"div",15)(4,"p-iconfield"),m(5,"p-inputicon",16),n(6,"input",17),c("input",function(o){f(e);let u=d();return _(u.applyFilter(o))}),t()()()(),n(7,"div",18)(8,"p-button",19),c("click",function(){f(e);let o=d();return _(o.gotToAddSupplier())}),t(),n(9,"p-button",20),c("onClick",function(){f(e);let o=d();return _(o.exportCSV())}),t()()(),n(10,"div",21)(11,"p-table",22,3),x(13,xt,10,0,"ng-template",null,0,C)(15,bt,15,5,"ng-template",null,4,C),t()()()}if(l&2){let e=d();a(11),s("value",e.suppliers)("globalFilterFields",y(6,vt))("tableStyle",y(7,St))("paginator",!0)("rows",40)("rowsPerPageOptions",y(8,yt))}}function wt(l,r){l&1&&(n(0,"div",29),m(1,"img",30),t())}function Et(l,r){l&1&&(n(0,"tr")(1,"th"),p(2,"Nom"),t(),n(3,"th"),p(4,"Prix"),t()())}function Ft(l,r){if(l&1&&(n(0,"tr")(1,"td"),p(2),t(),n(3,"td"),p(4),t()()),l&2){let e=r.$implicit;a(2),F(e.productName),a(2),_e("FCFA ",e.supplierPrice,"")}}function Nt(l,r){if(l&1){let e=S();n(0,"i",64),c("click",function(){f(e);let o=d().index,u=d(2);return _(u.removeProduct(o))}),t()}}function Mt(l,r){if(l&1){let e=S();n(0,"div",59)(1,"div",35)(2,"input",60),c("input",function(){let o=f(e).index,u=d(2);return _(u.addProductIfNeeded(o))}),t()(),n(3,"div",61)(4,"input",62),c("input",function(){let o=f(e).index,u=d(2);return _(u.addProductIfNeeded(o))}),t(),x(5,Nt,1,0,"i",63),t()()}if(l&2){let e=r.index,i=d(2);s("formGroupName",e),a(5),s("ngIf",i.productsSupplied.length>1)}}function Tt(l,r){if(l&1){let e=S();n(0,"p-fluid")(1,"form",31),c("ngSubmit",function(){f(e);let o=d();return _(o.onSubmit())}),n(2,"div",32)(3,"h4"),p(4,"Informations du fournisseur"),t(),n(5,"div",33)(6,"div",34)(7,"div",35)(8,"label",36),p(9,"Nom"),t(),m(10,"input",37),t(),n(11,"div",35)(12,"label",38),p(13,"Statut"),t(),m(14,"p-select",39),t()(),n(15,"div",40)(16,"div",35)(17,"label",41),p(18,"Adresse"),t(),m(19,"input",42),t(),n(20,"div",35)(21,"label",43),p(22,"Ville"),t(),m(23,"input",44),t()(),n(24,"div",40)(25,"div",35)(26,"label",45),p(27,"Code Postal"),t(),m(28,"input",46),t(),n(29,"div",35)(30,"label",47),p(31,"Pays"),t(),m(32,"p-select",48),t()(),n(33,"div",40)(34,"div",35)(35,"label",49),p(36,"T\xE9l\xE9phone"),t(),m(37,"input",50),t(),n(38,"div",35)(39,"label",51),p(40,"Email"),t(),m(41,"input",52),t()(),n(42,"div",40)(43,"div",35)(44,"label",53),p(45,"Site Web"),t(),m(46,"input",54),t(),n(47,"div",35)(48,"label",55),p(49,"M\xE9thode de paiement pr\xE9f\xE9r\xE9e"),t(),m(50,"p-select",56),t()()(),n(51,"h4"),p(52,"Produits fournis"),t(),n(53,"div",12)(54,"div",57),x(55,Mt,6,2,"div",58),t()()()()()}if(l&2){let e=d();a(),s("formGroup",e.supplierForm),a(9),s("ngClass",b(9,ae,e.erreurInput&&e.supplierForm.controls.name.errors)),a(4),s("options",e.status)("ngClass",b(11,ae,e.erreurInput&&e.supplierForm.controls.status.errors)),a(18),s("options",e.countries),a(5),s("ngClass",b(13,ae,e.erreurInput&&e.supplierForm.controls.phone.errors)),a(13),s("options",e.preferredPaymentMethod)("ngClass",b(15,ae,e.erreurInput&&e.supplierForm.controls.preferredPaymentMethod.errors)),a(5),s("ngForOf",e.productsSupplied.controls)}}function It(l,r){if(l&1){let e=S();n(0,"p-button",65),c("click",function(){f(e);let o=d();return _(o.clearForm())}),t(),n(1,"p-button",66),c("click",function(){f(e);let o=d();return _(o.onSubmit())}),t()}if(l&2){let e=d();a(),s("loading",e.loading)}}var ct,ft,_t,We,gt,ht,vt,St,yt,ae,se,Ze=me(()=>{"use strict";P();De();ee();Y();Se();Xe();$e();K();ne();Pe();Ae();Ye();ye();Ee();je();Fe();Se();K();De();P();Y();Ae();Pe();ne();ee();ye();ct=["dt"],ft=["op"],_t=()=>({width:"45vw","max-height":"50vh","overflow-y":"auto"}),We=()=>({"1199px":"75vw","575px":"90vw"}),gt=()=>({"min-width":"max-content"}),ht=()=>({width:"50vw","max-height":"90vh","overflow-y":"auto"}),vt=()=>["name","code","phone"],St=()=>({"min-width":"75vw"}),yt=()=>[10,20,40,60],ae=l=>({"ng-invalid ng-dirty":l});se=class l{constructor(r,e,i,o,u){this.supplierService=r;this.router=e;this.confirmationService=i;this.messageService=o;this.fb=u}dt;op;suppliers=[];visible=!1;supplierName;selectedSupplierProducts;supplierDetailsDialog=!1;supplierForm;erreurInput=!1;responseError;loading=!1;status=[{name:"Active",code:"0"},{name:"Inactive",code:"1"}];preferredPaymentMethod=[{name:"Orange Money",code:"OM"},{name:"MTN Money",code:"MTN"},{name:"Virement",code:"VIR"},{name:"Esp\xE8ce",code:"ESP"},{name:"Ch\xE8que",code:"CHQ"}];countries=[{name:"Afrique du Sud",code:"ZA"},{name:"Alg\xE9rie",code:"DZ"},{name:"Angola",code:"AO"},{name:"B\xE9nin",code:"BJ"},{name:"Botswana",code:"BW"},{name:"Burkina Faso",code:"BF"},{name:"Burundi",code:"BI"},{name:"Cap-Vert",code:"CV"},{name:"Cameroun",code:"CM"},{name:"R\xE9publique centrafricaine",code:"CF"},{name:"Comores",code:"KM"},{name:"R\xE9publique du Congo",code:"CG"},{name:"R\xE9publique d\xE9mocratique du Congo",code:"CD"},{name:"Djibouti",code:"DJ"},{name:"\xC9gypte",code:"EG"},{name:"Guin\xE9e \xE9quatoriale",code:"GQ"},{name:"\xC9rythr\xE9e",code:"ER"},{name:"Eswatini",code:"SZ"},{name:"\xC9thiopie",code:"ET"},{name:"Gabon",code:"GA"},{name:"Gambie",code:"GM"},{name:"Ghana",code:"GH"},{name:"Guin\xE9e",code:"GN"},{name:"Guin\xE9e-Bissau",code:"GW"},{name:"C\xF4te d'Ivoire",code:"CI"},{name:"Kenya",code:"KE"},{name:"Lesotho",code:"LS"},{name:"Liberia",code:"LR"},{name:"Libye",code:"LY"},{name:"Madagascar",code:"MG"},{name:"Malawi",code:"MW"},{name:"Mali",code:"ML"},{name:"Mauritanie",code:"MR"},{name:"Maurice",code:"MU"},{name:"Maroc",code:"MA"},{name:"Mozambique",code:"MZ"},{name:"Namibie",code:"NA"},{name:"Niger",code:"NE"},{name:"Nigeria",code:"NG"},{name:"Rwanda",code:"RW"},{name:"Sao Tom\xE9-et-Principe",code:"ST"},{name:"S\xE9n\xE9gal",code:"SN"},{name:"Seychelles",code:"SC"},{name:"Sierra Leone",code:"SL"},{name:"Somalie",code:"SO"},{name:"Soudan",code:"SD"},{name:"Soudan du Sud",code:"SS"},{name:"Tanzanie",code:"TZ"},{name:"Togo",code:"TG"},{name:"Tunisie",code:"TN"},{name:"Ouganda",code:"UG"},{name:"Zambie",code:"ZM"},{name:"Zimbabwe",code:"ZW"}];supplier={};ngOnInit(){this.supplierService.getAllSuppliers().subscribe({next:r=>{this.suppliers=r,console.log(this.suppliers)},error:r=>{console.error(r.error.error),this.showError(r.error.error)}}),this.supplierForm=this.fb.group({name:["",g.required],status:[null,g.required],address:[""],city:[""],postalCode:[""],country:[""],phone:["",g.required],email:["",[g.email]],website:[""],preferredPaymentMethod:[null,g.required],productsSupplied:this.fb.array([this.createProductFormGroup()])})}mapStatus(r){let e=this.status.find(i=>i.name===r);return e?parseInt(e.code,10):0}mapPaymentMethod(r){let e=this.preferredPaymentMethod.findIndex(i=>i.name===r);return e!==-1?e:0}mapCountry(r){let e=this.countries.findIndex(i=>i.name===r);return e!==-1?e:0}trash(r,e){this.confirmationService.confirm({target:r.target,message:"Voulez-vous supprimer ce fournisseur ?",header:"Supprimer",icon:"fa-solid fa-circle-info",rejectLabel:"annuler",rejectButtonProps:{label:"Annuler",severity:"secondary",outlined:!0},acceptButtonProps:{label:"Confirmer",severity:"danger"},accept:()=>{this.supplierService.deleteSupplier(e.id).subscribe({next:()=>{this.suppliers=this.suppliers.filter(i=>i.id!==e.id),this.showSuccess("Suppression r\xE9ussie")},error:()=>{this.showError("\xC9chec de la suppression")}})},reject:()=>{this.showError("supprission annul\xE9")}})}toggle(r){this.op.toggle(r)}showDialog(r){this.supplierService.get_products_supplied_by_supplier(r).subscribe({next:e=>{this.selectedSupplierProducts=e,console.log(e)},error:e=>{this.showError(e.error.error)}}),this.visible=!0}onSubmit(){if(this.loading=!0,console.log(this.supplierForm.value),this.supplierForm.valid){let r=this.supplierForm.value.productsSupplied.filter(i=>i.productName.trim()!==""&&i.price!==""),e=be(ue(ue({},this.supplier),this.supplierForm.value),{productsSupplied:r});this.supplierService.updateSupplier(e,this.supplier.id).subscribe({next:i=>{this.showSuccess("Fournisseur mis \xE0 jour avec succ\xE8s !"),this.loading=!1;let o=this.suppliers.findIndex(u=>u.id===this.supplier.id);o!==-1&&(this.suppliers[o]=i,this.suppliers=[...this.suppliers])},error:i=>{this.showError(i.error.error),this.loading=!1}})}else this.erreurInput=!0,this.loading=!1,console.log("Erreur dans le formulaire"),this.showError("Veuillez remplir tous les champs obligatoires.")}goToDetails(r){this.supplier=r,this.supplierService.get_products_supplied_by_supplier(r.name).subscribe({next:e=>{e.forEach(i=>{this.supplierForm=this.fb.group({name:[this.supplier.name,g.required],status:[this.status[this.mapStatus(this.supplier.status)],g.required],address:[this.supplier.address],city:[this.supplier.city],postalCode:[this.supplier.postalCode],country:[this.countries[this.mapCountry(this.supplier.country)]||null],phone:[this.supplier.phone,g.required],email:[this.supplier.email,[g.email]],website:[this.supplier.website],preferredPaymentMethod:[this.preferredPaymentMethod[this.mapPaymentMethod(this.supplier.preferredPaymentMethod)]||null,g.required],productsSupplied:this.fb.array([])}),this.addProduct(i)}),this.addProduct()},error:e=>{this.showError(e.error.error)}}),this.supplierDetailsDialog=!0}addProduct(r={productName:"",supplierPrice:null,SupplierName:null}){this.supplierForm.get("productsSupplied").push(this.fb.group({productName:[r.productName],price:[r.supplierPrice,[g.min(0)]]}))}get productsSupplied(){return this.supplierForm.get("productsSupplied")}createProductFormGroup(){return this.fb.group({productName:[""],price:["",[g.min(0)]]})}removeProduct(r){this.productsSupplied.length>1&&this.productsSupplied.removeAt(r)}addProductIfNeeded(r){let e=this.productsSupplied.at(r);if(e.get("productName")?.value!==""||e.get("price")?.value!==""){let i=this.productsSupplied.length-1;(this.productsSupplied.at(i).get("productName")?.value!==""||this.productsSupplied.at(i).get("price")?.value!=="")&&this.productsSupplied.push(this.createProductFormGroup())}}clearSelectedProducts(){this.selectedSupplierProducts=[]}applyFilter(r){let e=r.target;e&&this.dt.filterGlobal(e.value,"contains")}gotToAddSupplier(){this.router.navigate(["suppliers/addsupplier"])}exportCSV(){this.dt.exportCSV()}showSuccess(r){this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:r})}showError(r){this.messageService.add({severity:"error",summary:"Erreur",detail:r})}clearSelectedSuppliers(){this.selectedSupplierProducts=[]}clearForm(){this.supplierForm.reset()}static \u0275fac=function(e){return new(e||l)(v(oe),v(V),v(G),v(A),v(H))};static \u0275cmp=E({type:l,selectors:[["app-supplierslist"]],viewQuery:function(e,i){if(e&1&&(de(ct,5),de(ft,5)),e&2){let o;ce(o=fe())&&(i.dt=o.first),ce(o=fe())&&(i.op=o.first)}},features:[we([G])],decls:14,vars:25,consts:[["header",""],["content",""],["footer",""],["dt",""],["body",""],["class","card",4,"ngIf"],["style",`
        display: flex;
        align-items: center;
        justify-content: center;
        height: 89vh;
    `,4,"ngIf"],[1,""],["header","Les articles",3,"visibleChange","onHide","visible","modal","breakpoints","draggable","resizable"],["selectionMode","single",3,"value","tableStyle"],["pTemplate","body"],[3,"visibleChange","onHide","header","visible","modal","breakpoints","resizable"],[1,"card"],[1,"flex","justify-between","gap-4"],[1,"w-full"],[1,"flex","items-center","justify-between"],["styleClass","pi pi-search"],["pInputText","","type","text","placeholder","Rechercher un fournisseur...",3,"input"],[1,"flex","gap-4"],["label","Ajouter","icon","fa-solid fa-plus","severity","contrast",3,"click"],["label","Exporter","icon","pi pi-upload","severity","secondary",3,"onClick"],[1,"mt-4"],["selectionMode","single","dataKey","id",3,"value","globalFilterFields","tableStyle","paginator","rows","rowsPerPageOptions"],[1,"name-td"],[1,"showDialog"],["label","Voir les articles","severity","info","text","",3,"click"],[2,"display","flex","gap","1rem"],["label","","severity","info","icon","fa-solid fa-pencil",3,"onClick","outlined"],["label","","severity","danger","icon","fa-solid fa-trash-can",3,"click","outlined"],[2,"display","flex","align-items","center","justify-content","center","height","89vh"],["src","img/No data-rafiki.svg","alt","",2,"width","35rem"],[1,"w-full","mt-4",3,"ngSubmit","formGroup"],[1,"w-full","mt-4"],[1,"card","mt-6"],[1,"flex","flex-col","md:flex-row","gap-6","w-full"],[1,"flex","flex-wrap","gap-2","w-full"],["for","name"],["pInputText","","type","text","id","name","name","name","formControlName","name","required","",3,"ngClass"],["for","status"],["formControlName","status","optionLabel","name","required","",1,"w-full",3,"options","ngClass"],[1,"flex","flex-col","md:flex-row","gap-6","mt-8","w-full"],["for","address"],["pInputText","","type","text","id","address","name","address","formControlName","address"],["for","city"],["pInputText","","type","text","id","city","name","city","formControlName","city"],["for","postalCode"],["pInputText","","type","text","id","postalCode","name","postalCode","formControlName","postalCode","required",""],["for","country"],["formControlName","country","optionLabel","name",1,"w-full",3,"options"],["for","phone"],["pInputText","","type","text","id","phone","name","phone","formControlName","phone","required","",3,"ngClass"],["for","email"],["pInputText","","type","email","id","email","name","email","formControlName","email"],["for","website"],["pInputText","","type","url","id","website","name","website","formControlName","website"],["for","preferredPaymentMethod"],["formControlName","preferredPaymentMethod","optionLabel","name","required","",1,"w-full",3,"options","ngClass"],["id","productsSupplied","formArrayName","productsSupplied",1,""],["class","flex flex-col md:flex-row gap-6 m-4 w-full",3,"formGroupName",4,"ngFor","ngForOf"],[1,"flex","flex-col","md:flex-row","gap-6","m-4","w-full",3,"formGroupName"],["pInputText","","type","text","placeholder","Nom du produit","formControlName","productName",3,"input"],[1,"flex","gap-2","w-full",2,"align-items","center"],["pInputText","","type","number","placeholder","Prix","formControlName","price",3,"input"],["style",`
                                            margin-left: 1rem;
                                            cursor: pointer;
                                            color: red;
                                        `,"class","fa-solid fa-xmark",3,"click",4,"ngIf"],[1,"fa-solid","fa-xmark",2,"margin-left","1rem","cursor","pointer","color","red",3,"click"],["label","Vider","icon","pi pi-times","severity","danger","outlined","",3,"click"],["type","submit","label","Enregister","icon","pi pi-save","severity","contrast",3,"click","loading"]],template:function(e,i){if(e&1){let o=S();x(0,Ct,17,9,"div",5)(1,wt,2,0,"div",6),m(2,"p-confirmdialog"),n(3,"div",7)(4,"p-dialog",8),ve("visibleChange",function(h){return f(o),he(i.visible,h)||(i.visible=h),_(h)}),c("onHide",function(){return f(o),_(i.clearSelectedProducts())}),n(5,"p-table",9),x(6,Et,5,0,"ng-template",null,0,C)(8,Ft,5,2,"ng-template",10),t()()(),n(9,"p-dialog",11),ve("visibleChange",function(h){return f(o),he(i.supplierDetailsDialog,h)||(i.supplierDetailsDialog=h),_(h)}),c("onHide",function(){return f(o),_(i.clearSelectedSuppliers())}),x(10,Tt,56,17,"ng-template",null,1,C)(12,It,2,1,"ng-template",null,2,C),t()}e&2&&(s("ngIf",i.suppliers.length>0),a(),s("ngIf",i.suppliers.length<=0),a(3),w(y(20,_t)),ge("visible",i.visible),s("modal",!0)("breakpoints",y(21,We))("draggable",!0)("resizable",!1),a(),s("value",i.selectedSupplierProducts)("tableStyle",y(22,gt)),a(4),w(y(23,ht)),Ce("header","Details du fournisseur ",i.supplier.name,""),ge("visible",i.supplierDetailsDialog),s("modal",!0)("breakpoints",y(24,We))("resizable",!1)("modal",!0))},dependencies:[qe,Re,Ne,I,N,M,T,U,J,Le,Be,Ge,Ve,Ie,Te,re,ie,X,$,Me,ke,te,z,D,k,B,R,q,Z,Q,L,W,j,O],encapsulation:2})}});var fi,Pt=me(()=>{Oe();Ze();fi=[{path:"addsupplier",component:pe},{path:"supplierslist",component:se}]});Pt();export{fi as default};
